{"version":3,"sources":["hello.js","facebook.js","github.js","google.js","hello.amd.js"],"names":["hello","name","use","utils","extend","r","args","Array","prototype","slice","call","arguments","i","length","a","Object","x","settings","redirect_uri","window","location","href","split","response_type","display","state","oauth_proxy","timeout","default_service","force","page_uri","service","this","store","services","self","create","Event","init","options","hasOwnProperty","id","scope","url","login","emit","s","value","error","code","message","encodeFunction","_this","promise","Promise","p","network","callback","opts","merge","proxy","then","bind","reject","provider","callbackId","globalEvent","str","obj","JSON","parse","fulfill","authResponse","redirectUri","responseType","oauth","test","grant","replace","qs","client_id","encodeURIComponent","session","toString","pQsStateScopeArray","unique","join","m","serviceScopes","scope_delim","access_token","expires","Date","getTime","diff","unchanged","parseInt","version","refresh_token","stringify","auth","iframe","popup","window_width","window_height","timer","setInterval","closed","clearInterval","response","logout","_opts","undefined","getAuthResponse","events","params","formatFunction","reg","indexOf","RegExp","isEmpty","param","b","decodeURIComponent","match","o","push","localStorage","get","json","getItem","e","set","setItem","sessionStorage","removeItem","prop","document","cookie","_m","substr","days","append","node","attr","target","n","createElement","y","innerHTML","setAttribute","body","appendChild","setTimeout","getElementsByTagName","src","style","position","left","bottom","height","width","unshift","apply","t","path","URL","Function","filter","item","isArray","index","key","STATE_PENDING","STATE_FULFILLED","STATE_REJECTED","api","executor","fulfillValue","rejectReason","onFulfilled","onRejected","deliver","curr","next","resolver","execute","execute_handlers","handlers","func","process","nextTick","setImmediate","cb","method","result","resolve","TypeError","resolved","separator","parent","findEvents","on","evt","concat","off","handler","emitAfter","guid","Math","random","bool","console","windowWidth","windowHeight","documentElement","dualScreenLeft","screenLeft","screen","dualScreenTop","screenTop","top","innerWidth","clientWidth","innerHeight","clientHeight","open","addEventListener","redirectUriOrigin","origin","protocol","hostname","_popup","assign","search","hash","close","responseHandler","focus","navigator","userAgent","authCallback","closeWindow","oauth_token","proxy_url","expires_in","error_message","error_description","res","oauth_redirect","opener","oldSessions","expired","CURRENT_TIME","eventName","oldSess","refresh","getPath","defaults","val","query","base","request","headers","success","wrap","paging","data","toLowerCase","clone","actions","delete","xhr","jsonp","form","formatUrl","sign","proxy_response_type","suppress_response_codes","hasBinary","XMLHttpRequest","onprogress","upload","onuploadprogress","_query","callbackID","post","domInstance","type","toUpperCase","Element","tagName","String","Number","isBinary","map","headersToJSON","exec","binary","onload","responseText","_e","status","statusText","getAllResponseHeaders","statusCode","onerror","FormData","File","Blob","f","HTMLInputElement","files","overrideMimeType","setRequestHeader","send","operaFix","head","removeChild","script","async","onreadystatechange","readyState","text","newform","doc","reenableAfterSubmit","win","callbackonload","elements","disabled","encoding","enctype","input","el","inputs","NodeList","parentNode","innerText","getAttribute","submit","ee","FileList","toBlob","dataURI","atob","array","charCodeAt","Uint8Array","dataToJSON","w","nodeListToJSON","file","nodelist","formatUser","thumbnail","picture","formatFriends","forEach","format","req","token","d","cover_photo","photos","can_upload","upload_location","facebook","basic","email","birthday","videos","friends","publish_files","publish","offline_access","auth_type","redirect","me","me/friends","me/following","me/followers","me/share","me/like","me/files","me/albums","me/album","me/photos","me/photo","friend/albums","friend/photos","default","formatError","meta","avatar_url","Link","github","toInt","formatFeed","items","formatItem","title","thumbnailLink","mimeType","formatImage","source","gEntry","feed","entry","formatEntry","formatPerson","displayName","image","$t","gd$email","address","emails","updated","link","pic","category","_a","group","media$group","media","media$content","description","summary","updated_time","created_time","published","images","rel","scheme","term","media$thumbnail","openSearch$itemsPerPage","limit","start","openSearch$startIndex","total","openSearch$totalResults","nextPageToken","Multipart","addFile","fr","FileReader","addContent","btoa","lineBreak","readAsBinaryString","content","counter","ready","boundary","delim","dataUri","onready","fn","uploadDrive","parents","parts","toJSON","contactsUrl","google","create_event","access_type","me/contacts","me/feed","me/folders","me/folder","put","del","last_name","family_name","familyName","first_name","given_name","givenName","define","amd"],"mappings":"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","file":"hello-1.5.1.js","sourcesContent":["/**\n * @hello.js\n *\n * HelloJS is a client side Javascript SDK for making OAuth2 logins and subsequent REST calls.\n *\n * @author Andrew Dodson\n * @company Knarly\n *\n * @copyright Andrew Dodson, 2012 - 2015\n * @license MIT: You are free to use and modify this code for any use, on the condition that this copyright notice remains.\n */\n\nvar hello = function(name) {\n\treturn hello.use(name);\n};\n\nhello.utils = {\n\n\t// Extend the first object with the properties and methods of the second\n\textend: function(r /*, a[, b[, ...]] */) {\n\n\t\t// Get the arguments as an array but ommit the initial item\n\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\t\tfor (var i = 0; i < args.length; i++) {\n\t\t\tvar a = args[i];\n\t\t\tif (r instanceof Object && a instanceof Object && r !== a) {\n\t\t\t\tfor (var x in a) {\n\t\t\t\t\tr[x] = hello.utils.extend(r[x], a[x]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tr = a;\n\t\t\t}\n\t\t}\n\n\t\treturn r;\n\t}\n};\n\n// Core library\nhello.utils.extend(hello, {\n\n\tsettings: {\n\n\t\t// OAuth2 authentication defaults\n\t\tredirect_uri: window.location.href.split('#')[0],\n\t\tresponse_type: 'token',\n\t\tdisplay: 'popup',\n\t\tstate: '',\n\n\t\t// OAuth1 shim\n\t\t// The path to the OAuth1 server for signing user requests\n\t\t// Want to recreate your own? Checkout https://github.com/MrSwitch/node-oauth-shim\n\t\toauth_proxy: 'https://auth-server.herokuapp.com/proxy',\n\n\t\t// API timeout in milliseconds\n\t\ttimeout: 20000,\n\n\t\t// Default service / network\n\t\tdefault_service: null,\n\n\t\t// Force sign-in\n\t\t// When hello.login is fired, ignore current session expiry and continue with login\n\t\tforce: true,\n\n\t\t// Page URL\n\t\t// When 'display=page' this property defines where the users page should end up after redirect_uri\n\t\t// Ths could be problematic if the redirect_uri is indeed the final place,\n\t\t// Typically this circumvents the problem of the redirect_url being a dumb relay page.\n\t\tpage_uri: window.location.href\n\t},\n\n\t// Service\n\tservice: function(service) {\n\n\t\tif (typeof (service) !== 'undefined') {\n\t\t\treturn this.utils.store('sync_service', service);\n\t\t}\n\n\t\treturn this.utils.store('sync_service');\n\t},\n\n\t// Service configuration objects\n\tservices: {},\n\n\t// Use\n\t// Define a new instance of the HelloJS library with a default service\n\tuse: function(service) {\n\n\t\t// Create self, which inherits from its parent\n\t\tvar self = Object.create(this);\n\n\t\t// Inherit the prototype from its parent\n\t\tself.settings = Object.create(this.settings);\n\n\t\t// Define the default service\n\t\tif (service) {\n\t\t\tself.settings.default_service = service;\n\t\t}\n\n\t\t// Create an instance of Events\n\t\tself.utils.Event.call(self);\n\n\t\treturn self;\n\t},\n\n\t// Initialize\n\t// Define the client_ids for the endpoint services\n\t// @param object o, contains a key value pair, service => clientId\n\t// @param object opts, contains a key value pair of options used for defining the authentication defaults\n\t// @param number timeout, timeout in seconds\n\tinit: function(services, options) {\n\n\t\tvar utils = this.utils;\n\n\t\tif (!services) {\n\t\t\treturn this.services;\n\t\t}\n\n\t\t// Define provider credentials\n\t\t// Reformat the ID field\n\t\tfor (var x in services) {if (services.hasOwnProperty(x)) {\n\t\t\tif (typeof (services[x]) !== 'object') {\n\t\t\t\tservices[x] = {id: services[x]};\n\t\t\t}\n\t\t}}\n\n\t\t// Merge services if there already exists some\n\t\tutils.extend(this.services, services);\n\n\t\t// Format the incoming\n\t\tfor (x in this.services) {\n\t\t\tif (this.services.hasOwnProperty(x)) {\n\t\t\t\tthis.services[x].scope = this.services[x].scope || {};\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\t// Update the default settings with this one.\n\t\tif (options) {\n\t\t\tutils.extend(this.settings, options);\n\n\t\t\t// Do this immediatly incase the browser changes the current path.\n\t\t\tif ('redirect_uri' in options) {\n\t\t\t\tthis.settings.redirect_uri = utils.url(options.redirect_uri).href;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\t// Login\n\t// Using the endpoint\n\t// @param network stringify       name to connect to\n\t// @param options object    (optional)  {display mode, is either none|popup(default)|page, scope: email,birthday,publish, .. }\n\t// @param callback  function  (optional)  fired on signin\n\tlogin: function() {\n\n\t\t// Create an object which inherits its parent as the prototype and constructs a new event chain.\n\t\tvar _this = this;\n\t\tvar utils = _this.utils;\n\t\tvar promise = utils.Promise();\n\n\t\t// Get parameters\n\t\tvar p = utils.args({network: 's', options: 'o', callback: 'f'}, arguments);\n\n\t\t// Local vars\n\t\tvar url;\n\n\t\t// Merge/override options with app defaults\n\t\tvar opts = p.options = utils.merge(_this.settings, p.options || {});\n\n\t\t// Network\n\t\tp.network = p.network || _this.settings.default_service;\n\n\t\t// Bind callback to both reject and fulfill states\n\t\tpromise.proxy.then(p.callback, p.callback);\n\n\t\t// Trigger an event on the global listener\n\t\tfunction emit(s, value) {\n\t\t\thello.emit(s, value);\n\t\t}\n\n\t\tpromise.proxy.then(emit.bind(this, 'auth.login auth'), emit.bind(this, 'auth.failed auth'));\n\n\t\t// Is our service valid?\n\t\tif (typeof (p.network) !== 'string' || !(p.network in _this.services)) {\n\t\t\t// Trigger the default login.\n\t\t\t// Ahh we dont have one.\n\t\t\treturn promise.reject(error('invalid_network', 'The provided network was not recognized'));\n\t\t}\n\n\t\tvar provider = _this.services[p.network];\n\n\t\t// Create a global listener to capture events triggered out of scope\n\t\tvar callbackId = utils.globalEvent(function(str) {\n\n\t\t\t// The responseHandler returns a string, lets save this locally\n\t\t\tvar obj;\n\n\t\t\tif (str) {\n\t\t\t\tobj = JSON.parse(str);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tobj = error('cancelled', 'The authentication was not completed');\n\t\t\t}\n\n\t\t\t// Handle these response using the local\n\t\t\t// Trigger on the parent\n\t\t\tif (!obj.error) {\n\n\t\t\t\t// Save on the parent window the new credentials\n\t\t\t\t// This fixes an IE10 bug i think... atleast it does for me.\n\t\t\t\tutils.store(obj.network, obj);\n\n\t\t\t\t// Fulfill a successful login\n\t\t\t\tpromise.fulfill({\n\t\t\t\t\tnetwork: obj.network,\n\t\t\t\t\tauthResponse: obj\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Reject a successful login\n\t\t\t\tpromise.reject(obj);\n\t\t\t}\n\t\t});\n\n\t\tvar redirectUri = utils.url(opts.redirect_uri).href;\n\n\t\t// May be a space-delimited list of multiple, complementary types\n\t\tvar responseType = provider.oauth.response_type || opts.response_type;\n\n\t\t// Fallback to token if the module hasn't defined a grant url\n\t\tif (/\\bcode\\b/.test(responseType) && !provider.oauth.grant) {\n\t\t\tresponseType = responseType.replace(/\\bcode\\b/, 'token');\n\t\t}\n\n\t\t// Query string parameters, we may pass our own arguments to form the querystring\n\t\tp.qs = {\n\t\t\tclient_id: encodeURIComponent(provider.id),\n\t\t\tresponse_type: encodeURIComponent(responseType),\n\t\t\tredirect_uri: encodeURIComponent(redirectUri),\n\t\t\tdisplay: opts.display,\n\t\t\tscope: 'basic',\n\t\t\tstate: {\n\t\t\t\tclient_id: provider.id,\n\t\t\t\tnetwork: p.network,\n\t\t\t\tdisplay: opts.display,\n\t\t\t\tcallback: callbackId,\n\t\t\t\tstate: opts.state,\n\t\t\t\tredirect_uri: redirectUri\n\t\t\t}\n\t\t};\n\n\t\t// Get current session for merging scopes, and for quick auth response\n\t\tvar session = utils.store(p.network);\n\n\t\t// Scopes (authentication permisions)\n\t\t// Convert any array, or falsy value to a string.\n\t\tvar scope = (opts.scope || '').toString();\n\n\t\tscope = (scope ? scope + ',' : '') + p.qs.scope;\n\n\t\t// Append scopes from a previous session.\n\t\t// This helps keep app credentials constant,\n\t\t// Avoiding having to keep tabs on what scopes are authorized\n\t\tif (session && 'scope' in session && typeof session.scope === \"string\") {\n\t\t\tscope += ',' + session.scope;\n\t\t}\n\n\t\t// Save in the State\n\t\t// Convert to a string because IE, has a problem moving Arrays between windows\n    var pQsStateScopeArray = utils.unique(scope.split(/[,\\s]+/));\n    p.qs.state.scope = pQsStateScopeArray.join(',');\n\n\t\t// Map replace each scope with the providers default scopes\n\t\tp.qs.scope = scope.replace(/[^,\\s]+/ig, function(m) {\n\t\t\t// Does this have a mapping?\n\t\t\tif (m in provider.scope) {\n\t\t\t\treturn provider.scope[m];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Loop through all services and determine whether the scope is generic\n\t\t\t\tfor (var x in _this.services) {\n\t\t\t\t\tvar serviceScopes = _this.services[x].scope;\n\t\t\t\t\tif (serviceScopes && m in serviceScopes) {\n\t\t\t\t\t\t// Found an instance of this scope, so lets not assume its special\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// This is a unique scope to this service so lets in it.\n\t\t\t\treturn m;\n\t\t\t}\n\n\t\t}).replace(/[,\\s]+/ig, ',');\n\n\t\t// Remove duplication and empty spaces\n\t\tp.qs.scope = utils.unique(p.qs.scope.split(/,+/)).join(provider.scope_delim || ',');\n\n\t\t// Is the user already signed in with the appropriate scopes, valid access_token?\n\t\tif (opts.force === false) {\n\n\t\t\tif (session && 'access_token' in session && session.access_token && 'expires' in session && session.expires > ((new Date()).getTime() / 1e3)) {\n\t\t\t\t// What is different about the scopes in the session vs the scopes in the new login?\n        var diff = utils.diff(session.scope || [], pQsStateScopeArray);\n\t\t\t\tif (diff.length === 0) {\n\n\t\t\t\t\t// OK trigger the callback\n\t\t\t\t\tpromise.fulfill({\n\t\t\t\t\t\tunchanged: true,\n\t\t\t\t\t\tnetwork: p.network,\n\t\t\t\t\t\tauthResponse: session\n\t\t\t\t\t});\n\n\t\t\t\t\t// Nothing has changed\n\t\t\t\t\treturn promise;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Page URL\n\t\tif (opts.display === 'page' && opts.page_uri) {\n\t\t\t// Add a page location, place to endup after session has authenticated\n\t\t\tp.qs.state.page_uri = utils.url(opts.page_uri).href;\n\t\t}\n\n\t\t// Bespoke\n\t\t// Override login querystrings from auth_options\n\t\tif ('login' in provider && typeof (provider.login) === 'function') {\n\t\t\t// Format the paramaters according to the providers formatting function\n\t\t\tprovider.login(p);\n\t\t}\n\n\t\t// Add OAuth to state\n\t\t// Where the service is going to take advantage of the oauth_proxy\n\t\tif (!/\\btoken\\b/.test(responseType) ||\n\t\tparseInt(provider.oauth.version, 10) < 2 ||\n\t\t(opts.display === 'none' && provider.oauth.grant && session && session.refresh_token)) {\n\n\t\t\t// Add the oauth endpoints\n\t\t\tp.qs.state.oauth = provider.oauth;\n\n\t\t\t// Add the proxy url\n\t\t\tp.qs.state.oauth_proxy = opts.oauth_proxy;\n\n\t\t}\n\n\t\t// Convert state to a string\n\t\tp.qs.state = encodeURIComponent(JSON.stringify(p.qs.state));\n\n\t\t// URL\n\t\tif (parseInt(provider.oauth.version, 10) === 1) {\n\n\t\t\t// Turn the request to the OAuth Proxy for 3-legged auth\n\t\t\turl = utils.qs(opts.oauth_proxy, p.qs, encodeFunction);\n\t\t}\n\n\t\t// Refresh token\n\t\telse if (opts.display === 'none' && provider.oauth.grant && session && session.refresh_token) {\n\n\t\t\t// Add the refresh_token to the request\n\t\t\tp.qs.refresh_token = session.refresh_token;\n\n\t\t\t// Define the request path\n\t\t\turl = utils.qs(opts.oauth_proxy, p.qs, encodeFunction);\n\t\t}\n\t\telse {\n\t\t\turl = utils.qs(provider.oauth.auth, p.qs, encodeFunction);\n\t\t}\n\n\t\t// Execute\n\t\t// Trigger how we want self displayed\n\t\tif (opts.display === 'none') {\n\t\t\t// Sign-in in the background, iframe\n\t\t\tutils.iframe(url);\n\t\t}\n\n\t\t// Triggering popup?\n\t\telse if (opts.display === 'popup') {\n\n\t\t\tvar popup = utils.popup(url, redirectUri, opts.window_width || 500, opts.window_height || 550);\n\n\t\t\tvar timer = setInterval(function() {\n\t\t\t\tif (!popup || popup.closed) {\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\tif (!promise.state) {\n\n\t\t\t\t\t\tvar response = error('cancelled', 'Login has been cancelled');\n\n\t\t\t\t\t\tif (!popup) {\n\t\t\t\t\t\t\tresponse = error('blocked', 'Popup was blocked');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresponse.network = p.network;\n\n\t\t\t\t\t\tpromise.reject(response);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t}\n\n\t\telse {\n\t\t\twindow.location = url;\n\t\t}\n\n\t\treturn promise.proxy;\n\n\t\tfunction error(code, message) {\n\t\t\treturn {\n\t\t\t\terror: {\n\t\t\t\t\tcode: code,\n\t\t\t\t\tmessage: message\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tfunction encodeFunction(s) {return s;}\n\t},\n\n\t// Remove any data associated with a given service\n\t// @param string name of the service\n\t// @param function callback\n\tlogout: function() {\n\n\t\tvar _this = this;\n\t\tvar utils = _this.utils;\n\n\t\t// Create a new promise\n\t\tvar promise = utils.Promise();\n\n\t\tvar p = utils.args({name:'s', options: 'o', callback: 'f'}, arguments);\n\n\t\tp.options = p.options || {};\n\n\t\t// Add callback to events\n\t\tpromise.proxy.then(p.callback, p.callback);\n\n\t\t// Trigger an event on the global listener\n\t\tfunction emit(s, value) {\n\t\t\thello.emit(s, value);\n\t\t}\n\n\t\tpromise.proxy.then(emit.bind(this, 'auth.logout auth'), emit.bind(this, 'error'));\n\n\t\t// Network\n\t\tp.name = p.name || this.settings.default_service;\n\n\t\tif (p.name && !(p.name in _this.services)) {\n\n\t\t\tpromise.reject(error('invalid_network', 'The network was unrecognized'));\n\n\t\t}\n\t\telse if (p.name && utils.store(p.name)) {\n\n\t\t\t// Define the callback\n\t\t\tvar callback = function(opts) {\n\n\t\t\t\t// Remove from the store\n\t\t\t\tutils.store(p.name, '');\n\n\t\t\t\t// Emit events by default\n\t\t\t\tpromise.fulfill(hello.utils.merge({network:p.name}, opts || {}));\n\t\t\t};\n\n\t\t\t// Run an async operation to remove the users session\n\t\t\tvar _opts = {};\n\t\t\tif (p.options.force) {\n\t\t\t\tvar logout = _this.services[p.name].logout;\n\t\t\t\tif (logout) {\n\t\t\t\t\t// Convert logout to URL string,\n\t\t\t\t\t// If no string is returned, then this function will handle the logout async style\n\t\t\t\t\tif (typeof (logout) === 'function') {\n\t\t\t\t\t\tlogout = logout(callback);\n\t\t\t\t\t}\n\n\t\t\t\t\t// If logout is a string then assume URL and open in iframe.\n\t\t\t\t\tif (typeof (logout) === 'string') {\n\t\t\t\t\t\tutils.iframe(logout);\n\t\t\t\t\t\t_opts.force = null;\n\t\t\t\t\t\t_opts.message = 'Logout success on providers site was indeterminate';\n\t\t\t\t\t}\n\t\t\t\t\telse if (logout === undefined) {\n\t\t\t\t\t\t// The callback function will handle the response.\n\t\t\t\t\t\treturn promise.proxy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove local credentials\n\t\t\tcallback(_opts);\n\t\t}\n\t\telse {\n\t\t\tpromise.reject(error('invalid_session', 'There was no session to remove'));\n\t\t}\n\n\t\treturn promise.proxy;\n\n\t\tfunction error(code, message) {\n\t\t\treturn {\n\t\t\t\terror: {\n\t\t\t\t\tcode: code,\n\t\t\t\t\tmessage: message\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\n\t// Returns all the sessions that are subscribed too\n\t// @param string optional, name of the service to get information about.\n\tgetAuthResponse: function(service) {\n\n\t\t// If the service doesn't exist\n\t\tservice = service || this.settings.default_service;\n\n\t\tif (!service || !(service in this.services)) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.utils.store(service) || null;\n\t},\n\n\t// Events: placeholder for the events\n\tevents: {}\n});\n\n// Core utilities\nhello.utils.extend(hello.utils, {\n\n\t// Append the querystring to a url\n\t// @param string url\n\t// @param object parameters\n\tqs: function(url, params, formatFunction) {\n\t\tif (params) {\n\t\t\tvar reg;\n\t\t\tfor (var x in params) {\n\t\t\t\tif (url.indexOf(x) > -1) {\n\t\t\t\t\tvar str = '[\\\\?\\\\&]' + x + '=[^\\\\&]*';\n\t\t\t\t\treg = new RegExp(str);\n\t\t\t\t\turl = url.replace(reg, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn url + (!this.isEmpty(params) ? (url.indexOf('?') > -1 ? '&' : '?') + this.param(params, formatFunction) : '');\n\t},\n\n\t// Param\n\t// Explode/encode the parameters of an URL string/object\n\t// @param string s, string to decode\n\tparam: function(s, formatFunction) {\n\t\tvar b;\n\t\tvar a = {};\n\t\tvar m;\n\n\t\tif (typeof (s) === 'string') {\n\n\t\t\tformatFunction = formatFunction || decodeURIComponent;\n\n\t\t\tm = s.replace(/^[\\#\\?]/, '').match(/([^=\\/\\&]+)=([^\\&]+)/g);\n\t\t\tif (m) {\n\t\t\t\tfor (var i = 0; i < m.length; i++) {\n\t\t\t\t\tb = m[i].match(/([^=]+)=(.*)/);\n\t\t\t\t\ta[b[1]] = formatFunction(b[2]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn a;\n\t\t}\n\t\telse {\n\n\t\t\tformatFunction = formatFunction || encodeURIComponent;\n\n\t\t\tvar o = s;\n\n\t\t\ta = [];\n\n\t\t\tfor (var x in o) {if (o.hasOwnProperty(x)) {\n\t\t\t\tif (o.hasOwnProperty(x)) {\n\t\t\t\t\ta.push([x, o[x] === '?' ? '?' : formatFunction(o[x])].join('='));\n\t\t\t\t}\n\t\t\t}}\n\n\t\t\treturn a.join('&');\n\t\t}\n\t},\n\n\t// Local storage facade\n\tstore: (function(localStorage) {\n\n\t\tvar a = [localStorage, window.sessionStorage];\n\t\tvar i = 0;\n\n\t\t// Set LocalStorage\n\t\tlocalStorage = a[i++];\n\n\t\twhile (localStorage) {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(i, i);\n\t\t\t\tlocalStorage.removeItem(i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tlocalStorage = a[i++];\n\t\t\t}\n\t\t}\n\n\t\tif (!localStorage) {\n\t\t\tlocalStorage = {\n\t\t\t\tgetItem: function(prop) {\n\t\t\t\t\tprop = prop + '=';\n\t\t\t\t\tvar m = document.cookie.split(';');\n\t\t\t\t\tfor (var i = 0; i < m.length; i++) {\n\t\t\t\t\t\tvar _m = m[i].replace(/(^\\s+|\\s+$)/, '');\n\t\t\t\t\t\tif (_m && _m.indexOf(prop) === 0) {\n\t\t\t\t\t\t\treturn _m.substr(prop.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t},\n\n\t\t\t\tsetItem: function(prop, value) {\n\t\t\t\t\tdocument.cookie = prop + '=' + value;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tfunction get() {\n\t\t\tvar json = {};\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse(localStorage.getItem('hello')) || {};\n\t\t\t}\n\t\t\tcatch (e) {}\n\n\t\t\treturn json;\n\t\t}\n\n\t\tfunction set(json) {\n\t\t\tlocalStorage.setItem('hello', JSON.stringify(json));\n\t\t}\n\n\t\t// Check if the browser support local storage\n\t\treturn function(name, value, days) {\n\n\t\t\t// Local storage\n\t\t\tvar json = get();\n\n\t\t\tif (name && value === undefined) {\n\t\t\t\treturn json[name] || null;\n\t\t\t}\n\t\t\telse if (name && value === null) {\n\t\t\t\ttry {\n\t\t\t\t\tdelete json[name];\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tjson[name] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (name) {\n\t\t\t\tjson[name] = value;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn json;\n\t\t\t}\n\n\t\t\tset(json);\n\n\t\t\treturn json || null;\n\t\t};\n\n\t})(window.localStorage),\n\n\t// Create and Append new DOM elements\n\t// @param node string\n\t// @param attr object literal\n\t// @param dom/string\n\tappend: function(node, attr, target) {\n\n\t\tvar n = typeof (node) === 'string' ? document.createElement(node) : node;\n\n\t\tif (typeof (attr) === 'object') {\n\t\t\tif ('tagName' in attr) {\n\t\t\t\ttarget = attr;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (var x in attr) {if (attr.hasOwnProperty(x)) {\n\t\t\t\t\tif (typeof (attr[x]) === 'object') {\n\t\t\t\t\t\tfor (var y in attr[x]) {if (attr[x].hasOwnProperty(y)) {\n\t\t\t\t\t\t\tn[x][y] = attr[x][y];\n\t\t\t\t\t\t}}\n\t\t\t\t\t}\n\t\t\t\t\telse if (x === 'html') {\n\t\t\t\t\t\tn.innerHTML = attr[x];\n\t\t\t\t\t}\n\n\t\t\t\t\t// IE doesn't like us setting methods with setAttribute\n\t\t\t\t\telse if (!/^on/.test(x)) {\n\t\t\t\t\t\tn.setAttribute(x, attr[x]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tn[x] = attr[x];\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t}\n\t\t}\n\n\t\tif (target === 'body') {\n\t\t\t(function self() {\n\t\t\t\tif (document.body) {\n\t\t\t\t\tdocument.body.appendChild(n);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tsetTimeout(self, 16);\n\t\t\t\t}\n\t\t\t})();\n\t\t}\n\t\telse if (typeof (target) === 'object') {\n\t\t\ttarget.appendChild(n);\n\t\t}\n\t\telse if (typeof (target) === 'string') {\n\t\t\tdocument.getElementsByTagName(target)[0].appendChild(n);\n\t\t}\n\n\t\treturn n;\n\t},\n\n\t// An easy way to create a hidden iframe\n\t// @param string src\n\tiframe: function(src) {\n\t\tthis.append('iframe', {src: src, style: {position:'absolute', left: '-1000px', bottom: 0, height: '1px', width: '1px'}}, 'body');\n\t},\n\n\t// Recursive merge two objects into one, second parameter overides the first\n\t// @param a array\n\tmerge: function(/* Args: a, b, c, .. n */) {\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\targs.unshift({});\n\t\treturn this.extend.apply(null, args);\n\t},\n\n\t// Makes it easier to assign parameters, where some are optional\n\t// @param o object\n\t// @param a arguments\n\targs: function(o, args) {\n\n\t\tvar p = {};\n\t\tvar i = 0;\n\t\tvar t = null;\n\t\tvar x = null;\n\n\t\t// 'x' is the first key in the list of object parameters\n\t\tfor (x in o) {if (o.hasOwnProperty(x)) {\n\t\t\tbreak;\n\t\t}}\n\n\t\t// Passing in hash object of arguments?\n\t\t// Where the first argument can't be an object\n\t\tif ((args.length === 1) && (typeof (args[0]) === 'object') && o[x] != 'o!') {\n\n\t\t\t// Could this object still belong to a property?\n\t\t\t// Check the object keys if they match any of the property keys\n\t\t\tfor (x in args[0]) {if (o.hasOwnProperty(x)) {\n\t\t\t\t// Does this key exist in the property list?\n\t\t\t\tif (x in o) {\n\t\t\t\t\t// Yes this key does exist so its most likely this function has been invoked with an object parameter\n\t\t\t\t\t// Return first argument as the hash of all arguments\n\t\t\t\t\treturn args[0];\n\t\t\t\t}\n\t\t\t}}\n\t\t}\n\n\t\t// Else loop through and account for the missing ones.\n\t\tfor (x in o) {if (o.hasOwnProperty(x)) {\n\n\t\t\tt = typeof (args[i]);\n\n\t\t\tif ((typeof (o[x]) === 'function' && o[x].test(args[i])) || (typeof (o[x]) === 'string' && (\n\t\t\t(o[x].indexOf('s') > -1 && t === 'string') ||\n\t\t\t(o[x].indexOf('o') > -1 && t === 'object') ||\n\t\t\t(o[x].indexOf('i') > -1 && t === 'number') ||\n\t\t\t(o[x].indexOf('a') > -1 && t === 'object') ||\n\t\t\t(o[x].indexOf('f') > -1 && t === 'function')\n\t\t\t))\n\t\t\t) {\n\t\t\t\tp[x] = args[i++];\n\t\t\t}\n\n\t\t\telse if (typeof (o[x]) === 'string' && o[x].indexOf('!') > -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}}\n\n\t\treturn p;\n\t},\n\n\t// Returns a URL instance\n\turl: function(path) {\n\n\t\t// If the path is empty\n\t\tif (!path) {\n\t\t\treturn window.location;\n\t\t}\n\n\t\t// Chrome and FireFox support new URL() to extract URL objects\n\t\telse if (window.URL && URL instanceof Function && URL.length !== 0) {\n\t\t\treturn new URL(path, window.location);\n\t\t}\n\n\t\t// Ugly shim, it works!\n\t\telse {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.href = path;\n\t\t\treturn a;\n\t\t}\n\t},\n\n\tdiff: function(a, b) {\n\t\treturn b.filter(function(item) {\n\t\t\treturn a.indexOf(item) === -1;\n\t\t});\n\t},\n\n\t// Unique\n\t// Remove duplicate and null values from an array\n\t// @param a array\n\tunique: function(a) {\n\t\tif (!Array.isArray(a)) { return []; }\n\n\t\treturn a.filter(function(item, index) {\n\t\t\t// Is this the first location of item\n\t\t\treturn a.indexOf(item) === index;\n\t\t});\n\t},\n\n\tisEmpty: function(obj) {\n\n\t\t// Scalar\n\t\tif (!obj)\n\t\t\treturn true;\n\n\t\t// Array\n\t\tif (Array.isArray(obj)) {\n\t\t\treturn !obj.length;\n\t\t}\n\t\telse if (typeof (obj) === 'object') {\n\t\t\t// Object\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t//jscs:disable\n\n\t/*!\n\t **  Thenable -- Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable\n\t **  Copyright (c) 2013-2014 Ralf S. Engelschall <http://engelschall.com>\n\t **  Licensed under The MIT License <http://opensource.org/licenses/MIT>\n\t **  Source-Code distributed on <http://github.com/rse/thenable>\n\t */\n\tPromise: (function(){\n\t\t/*  promise states [Promises/A+ 2.1]  */\n\t\tvar STATE_PENDING   = 0;                                         /*  [Promises/A+ 2.1.1]  */\n\t\tvar STATE_FULFILLED = 1;                                         /*  [Promises/A+ 2.1.2]  */\n\t\tvar STATE_REJECTED  = 2;                                         /*  [Promises/A+ 2.1.3]  */\n\n\t\t/*  promise object constructor  */\n\t\tvar api = function (executor) {\n\t\t\t/*  optionally support non-constructor/plain-function call  */\n\t\t\tif (!(this instanceof api))\n\t\t\t\treturn new api(executor);\n\n\t\t\t/*  initialize object  */\n\t\t\tthis.id           = \"Thenable/1.0.6\";\n\t\t\tthis.state        = STATE_PENDING; /*  initial state  */\n\t\t\tthis.fulfillValue = undefined;     /*  initial value  */     /*  [Promises/A+ 1.3, 2.1.2.2]  */\n\t\t\tthis.rejectReason = undefined;     /*  initial reason */     /*  [Promises/A+ 1.5, 2.1.3.2]  */\n\t\t\tthis.onFulfilled  = [];            /*  initial handlers  */\n\t\t\tthis.onRejected   = [];            /*  initial handlers  */\n\n\t\t\t/*  provide optional information-hiding proxy  */\n\t\t\tthis.proxy = {\n\t\t\t\tthen: this.then.bind(this)\n\t\t\t};\n\n\t\t\t/*  support optional executor function  */\n\t\t\tif (typeof executor === \"function\")\n\t\t\t\texecutor.call(this, this.fulfill.bind(this), this.reject.bind(this));\n\t\t};\n\n\t\t/*  promise API methods  */\n\t\tapi.prototype = {\n\t\t\t/*  promise resolving methods  */\n\t\t\tfulfill: function (value) { return deliver(this, STATE_FULFILLED, \"fulfillValue\", value); },\n\t\t\treject:  function (value) { return deliver(this, STATE_REJECTED,  \"rejectReason\", value); },\n\n\t\t\t/*  \"The then Method\" [Promises/A+ 1.1, 1.2, 2.2]  */\n\t\t\tthen: function (onFulfilled, onRejected) {\n\t\t\t\tvar curr = this;\n\t\t\t\tvar next = new api();                                    /*  [Promises/A+ 2.2.7]  */\n\t\t\t\tcurr.onFulfilled.push(\n\t\t\t\t\tresolver(onFulfilled, next, \"fulfill\"));             /*  [Promises/A+ 2.2.2/2.2.6]  */\n\t\t\t\tcurr.onRejected.push(\n\t\t\t\t\tresolver(onRejected,  next, \"reject\" ));             /*  [Promises/A+ 2.2.3/2.2.6]  */\n\t\t\t\texecute(curr);\n\t\t\t\treturn next.proxy;                                       /*  [Promises/A+ 2.2.7, 3.3]  */\n\t\t\t}\n\t\t};\n\n\t\t/*  deliver an action  */\n\t\tvar deliver = function (curr, state, name, value) {\n\t\t\tif (curr.state === STATE_PENDING) {\n\t\t\t\tcurr.state = state;                                      /*  [Promises/A+ 2.1.2.1, 2.1.3.1]  */\n\t\t\t\tcurr[name] = value;                                      /*  [Promises/A+ 2.1.2.2, 2.1.3.2]  */\n\t\t\t\texecute(curr);\n\t\t\t}\n\t\t\treturn curr;\n\t\t};\n\n\t\t/*  execute all handlers  */\n\t\tvar execute = function (curr) {\n\t\t\tif (curr.state === STATE_FULFILLED)\n\t\t\t\texecute_handlers(curr, \"onFulfilled\", curr.fulfillValue);\n\t\t\telse if (curr.state === STATE_REJECTED)\n\t\t\t\texecute_handlers(curr, \"onRejected\",  curr.rejectReason);\n\t\t};\n\n\t\t/*  execute particular set of handlers  */\n\t\tvar execute_handlers = function (curr, name, value) {\n\t\t\t/* global process: true */\n\t\t\t/* global setImmediate: true */\n\t\t\t/* global setTimeout: true */\n\n\t\t\t/*  short-circuit processing  */\n\t\t\tif (curr[name].length === 0)\n\t\t\t\treturn;\n\n\t\t\t/*  iterate over all handlers, exactly once  */\n\t\t\tvar handlers = curr[name];\n\t\t\tcurr[name] = [];                                             /*  [Promises/A+ 2.2.2.3, 2.2.3.3]  */\n\t\t\tvar func = function () {\n\t\t\t\tfor (var i = 0; i < handlers.length; i++)\n\t\t\t\t\thandlers[i](value);                                  /*  [Promises/A+ 2.2.5]  */\n\t\t\t};\n\n\t\t\t/*  execute procedure asynchronously  */                     /*  [Promises/A+ 2.2.4, 3.1]  */\n\t\t\tif (typeof process === \"object\" && typeof process.nextTick === \"function\")\n\t\t\t\tprocess.nextTick(func);\n\t\t\telse if (typeof setImmediate === \"function\")\n\t\t\t\tsetImmediate(func);\n\t\t\telse\n\t\t\t\tsetTimeout(func, 0);\n\t\t};\n\n\t\t/*  generate a resolver function  */\n\t\tvar resolver = function (cb, next, method) {\n\t\t\treturn function (value) {\n\t\t\t\tif (typeof cb !== \"function\")                            /*  [Promises/A+ 2.2.1, 2.2.7.3, 2.2.7.4]  */\n\t\t\t\t\tnext[method].call(next, value);                      /*  [Promises/A+ 2.2.7.3, 2.2.7.4]  */\n\t\t\t\telse {\n\t\t\t\t\tvar result;\n\t\t\t\t\ttry { result = cb(value); }                          /*  [Promises/A+ 2.2.2.1, 2.2.3.1, 2.2.5, 3.2]  */\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\tnext.reject(e);                                  /*  [Promises/A+ 2.2.7.2]  */\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tresolve(next, result);                               /*  [Promises/A+ 2.2.7.1]  */\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\n\t\t/*  \"Promise Resolution Procedure\"  */                           /*  [Promises/A+ 2.3]  */\n\t\tvar resolve = function (promise, x) {\n\t\t\t/*  sanity check arguments  */                               /*  [Promises/A+ 2.3.1]  */\n\t\t\tif (promise === x || promise.proxy === x) {\n\t\t\t\tpromise.reject(new TypeError(\"cannot resolve promise with itself\"));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*  surgically check for a \"then\" method\n\t\t\t\t(mainly to just call the \"getter\" of \"then\" only once)  */\n\t\t\tvar then;\n\t\t\tif ((typeof x === \"object\" && x !== null) || typeof x === \"function\") {\n\t\t\t\ttry { then = x.then; }                                   /*  [Promises/A+ 2.3.3.1, 3.5]  */\n\t\t\t\tcatch (e) {\n\t\t\t\t\tpromise.reject(e);                                   /*  [Promises/A+ 2.3.3.2]  */\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*  handle own Thenables    [Promises/A+ 2.3.2]\n\t\t\t\tand similar \"thenables\" [Promises/A+ 2.3.3]  */\n\t\t\tif (typeof then === \"function\") {\n\t\t\t\tvar resolved = false;\n\t\t\t\ttry {\n\t\t\t\t\t/*  call retrieved \"then\" method */                  /*  [Promises/A+ 2.3.3.3]  */\n\t\t\t\t\tthen.call(x,\n\t\t\t\t\t\t/*  resolvePromise  */                           /*  [Promises/A+ 2.3.3.3.1]  */\n\t\t\t\t\t\tfunction (y) {\n\t\t\t\t\t\t\tif (resolved) return; resolved = true;       /*  [Promises/A+ 2.3.3.3.3]  */\n\t\t\t\t\t\t\tif (y === x)                                 /*  [Promises/A+ 3.6]  */\n\t\t\t\t\t\t\t\tpromise.reject(new TypeError(\"circular thenable chain\"));\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tresolve(promise, y);\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t/*  rejectPromise  */                            /*  [Promises/A+ 2.3.3.3.2]  */\n\t\t\t\t\t\tfunction (r) {\n\t\t\t\t\t\t\tif (resolved) return; resolved = true;       /*  [Promises/A+ 2.3.3.3.3]  */\n\t\t\t\t\t\t\tpromise.reject(r);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tif (!resolved)                                       /*  [Promises/A+ 2.3.3.3.3]  */\n\t\t\t\t\t\tpromise.reject(e);                               /*  [Promises/A+ 2.3.3.3.4]  */\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/*  handle other values  */\n\t\t\tpromise.fulfill(x);                                          /*  [Promises/A+ 2.3.4, 2.3.3.4]  */\n\t\t};\n\n\t\t/*  export API  */\n\t\treturn api;\n\t})(),\n\n\t//jscs:enable\n\n\t// Event\n\t// A contructor superclass for adding event menthods, on, off, emit.\n\tEvent: function() {\n\n\t\tvar separator = /[\\s\\,]+/;\n\n\t\t// If this doesn't support getPrototype then we can't get prototype.events of the parent\n\t\t// So lets get the current instance events, and add those to a parent property\n\t\tthis.parent = {\n\t\t\tevents: this.events,\n\t\t\tfindEvents: this.findEvents,\n\t\t\tparent: this.parent,\n\t\t\tutils: this.utils\n\t\t};\n\n\t\tthis.events = {};\n\n\t\t// On, subscribe to events\n\t\t// @param evt   string\n\t\t// @param callback  function\n\t\tthis.on = function(evt, callback) {\n\n\t\t\tif (callback && typeof (callback) === 'function') {\n\t\t\t\tvar a = evt.split(separator);\n\t\t\t\tfor (var i = 0; i < a.length; i++) {\n\n\t\t\t\t\t// Has this event already been fired on this instance?\n\t\t\t\t\tthis.events[a[i]] = [callback].concat(this.events[a[i]] || []);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this;\n\t\t};\n\n\t\t// Off, unsubscribe to events\n\t\t// @param evt   string\n\t\t// @param callback  function\n\t\tthis.off = function(evt, callback) {\n\n\t\t\tthis.findEvents(evt, function(name, index) {\n\t\t\t\tif (!callback || this.events[name][index] === callback) {\n\t\t\t\t\tthis.events[name][index] = null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this;\n\t\t};\n\n\t\t// Emit\n\t\t// Triggers any subscribed events\n\t\tthis.emit = function(evt /*, data, ... */) {\n\n\t\t\t// Get arguments as an Array, knock off the first one\n\t\t\tvar args = Array.prototype.slice.call(arguments, 1);\n\t\t\targs.push(evt);\n\n\t\t\t// Handler\n\t\t\tvar handler = function(name, index) {\n\n\t\t\t\t// Replace the last property with the event name\n\t\t\t\targs[args.length - 1] = (name === '*' ? evt : name);\n\n\t\t\t\t// Trigger\n\t\t\t\tthis.events[name][index].apply(this, args);\n\t\t\t};\n\n\t\t\t// Find the callbacks which match the condition and call\n\t\t\tvar _this = this;\n\t\t\twhile (_this && _this.findEvents) {\n\n\t\t\t\t// Find events which match\n\t\t\t\t_this.findEvents(evt + ',*', handler);\n\t\t\t\t_this = _this.parent;\n\t\t\t}\n\n\t\t\treturn this;\n\t\t};\n\n\t\t//\n\t\t// Easy functions\n\t\tthis.emitAfter = function() {\n\t\t\tvar _this = this;\n\t\t\tvar args = arguments;\n\t\t\tsetTimeout(function() {\n\t\t\t\t_this.emit.apply(_this, args);\n\t\t\t}, 0);\n\n\t\t\treturn this;\n\t\t};\n\n\t\tthis.findEvents = function(evt, callback) {\n\n\t\t\tvar a = evt.split(separator);\n\n\t\t\tfor (var name in this.events) {if (this.events.hasOwnProperty(name)) {\n\n\t\t\t\tif (a.indexOf(name) > -1) {\n\n\t\t\t\t\tfor (var i = 0; i < this.events[name].length; i++) {\n\n\t\t\t\t\t\t// Does the event handler exist?\n\t\t\t\t\t\tif (this.events[name][i]) {\n\t\t\t\t\t\t\t// Emit on the local instance of this\n\t\t\t\t\t\t\tcallback.call(this, name, i);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}}\n\t\t};\n\n\t\treturn this;\n\t},\n\n\t// Global Events\n\t// Attach the callback to the window object\n\t// Return its unique reference\n\tglobalEvent: function(callback, guid) {\n\t\t// If the guid has not been supplied then create a new one.\n\t\tguid = guid || '_hellojs_' + parseInt(Math.random() * 1e12, 10).toString(36);\n\n\t\t// Define the callback function\n\t\twindow[guid] = function() {\n\t\t\t// Trigger the callback\n\t\t\ttry {\n\t\t\t\tbool = callback.apply(this, arguments);\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\n\t\t\tif (bool) {\n\t\t\t\t// Remove this handler reference\n\t\t\t\ttry {\n\t\t\t\t\tdelete window[guid];\n\t\t\t\t}\n\t\t\t\tcatch (e) {}\n\t\t\t}\n\t\t};\n\n\t\treturn guid;\n\t},\n\n\t// Trigger a clientside popup\n\t// This has been augmented to support PhoneGap\n\tpopup: function(url, redirectUri, windowWidth, windowHeight) {\n\n\t\tvar documentElement = document.documentElement;\n\n\t\t// Multi Screen Popup Positioning (http://stackoverflow.com/a/16861050)\n\t\t// Credit: http://www.xtf.dk/2011/08/center-new-popup-window-even-on.html\n\t\t// Fixes dual-screen position                         Most browsers      Firefox\n\t\tvar dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : screen.left;\n\t\tvar dualScreenTop = window.screenTop !== undefined ? window.screenTop : screen.top;\n\n\t\tvar width = window.innerWidth || documentElement.clientWidth || screen.width;\n\t\tvar height = window.innerHeight || documentElement.clientHeight || screen.height;\n\n\t\tvar left = ((width - windowWidth) / 2) + dualScreenLeft;\n\t\tvar top = ((height - windowHeight) / 2) + dualScreenTop;\n\n\t\t// Create a function for reopening the popup, and assigning events to the new popup object\n\t\t// This is a fix whereby triggering the\n\t\tvar open = function(url) {\n\n\t\t\t// Trigger callback\n\t\t\tvar popup = window.open(\n\t\t\t\turl,\n\t\t\t\t'_blank',\n\t\t\t\t'resizeable=true,height=' + windowHeight + ',width=' + windowWidth + ',left=' + left + ',top=' + top\n\t\t\t);\n\n\t\t\t// PhoneGap support\n\t\t\t// Add an event listener to listen to the change in the popup windows URL\n\t\t\t// This must appear before popup.focus();\n\t\t\tif (popup && popup.addEventListener) {\n\n\t\t\t\t// Get the origin of the redirect URI\n\n\t\t\t\tvar a = hello.utils.url(redirectUri);\n\t\t\t\tvar redirectUriOrigin = a.origin || (a.protocol + '//' + a.hostname);\n\n\t\t\t\t// Listen to changes in the InAppBrowser window\n\n\t\t\t\tpopup.addEventListener('loadstart', function(e) {\n\n\t\t\t\t\tvar url = e.url;\n\n\t\t\t\t\t// Is this the path, as given by the redirectUri?\n\t\t\t\t\t// Check the new URL agains the redirectUriOrigin.\n\t\t\t\t\t// According to #63 a user could click 'cancel' in some dialog boxes ....\n\t\t\t\t\t// The popup redirects to another page with the same origin, yet we still wish it to close.\n\n\t\t\t\t\tif (url.indexOf(redirectUriOrigin) !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Split appart the URL\n\t\t\t\t\tvar a = hello.utils.url(url);\n\n\t\t\t\t\t// We dont have window operations on the popup so lets create some\n\t\t\t\t\t// The location can be augmented in to a location object like so...\n\n\t\t\t\t\tvar _popup = {\n\t\t\t\t\t\tlocation: {\n\t\t\t\t\t\t\t// Change the location of the popup\n\t\t\t\t\t\t\tassign: function(location) {\n\n\t\t\t\t\t\t\t\t// Unfourtunatly an app is may not change the location of a InAppBrowser window.\n\t\t\t\t\t\t\t\t// So to shim this, just open a new one.\n\n\t\t\t\t\t\t\t\tpopup.addEventListener('exit', function() {\n\n\t\t\t\t\t\t\t\t\t// For some reason its failing to close the window if a new window opens too soon.\n\n\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\topen(location);\n\t\t\t\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\tsearch: a.search,\n\t\t\t\t\t\t\thash: a.hash,\n\t\t\t\t\t\t\thref: a.href\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclose: function() {\n\t\t\t\t\t\t\tif (popup.close) {\n\t\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\t// Then this URL contains information which HelloJS must process\n\t\t\t\t\t// URL string\n\t\t\t\t\t// Window - any action such as window relocation goes here\n\t\t\t\t\t// Opener - the parent window which opened this, aka this script\n\n\t\t\t\t\thello.utils.responseHandler(_popup, window);\n\n\t\t\t\t\t// Always close the popup reguardless of whether the hello.utils.responseHandler detects a state parameter or not in the querystring.\n\t\t\t\t\t// Such situations might arise such as those in #63\n\n\t\t\t\t\t_popup.close();\n\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (popup && popup.focus) {\n\t\t\t\tpopup.focus();\n\t\t\t}\n\n\t\t\treturn popup;\n\t\t};\n\n\t\t// Call the open() function with the initial path\n\t\t//\n\t\t// OAuth redirect, fixes URI fragments from being lost in Safari\n\t\t// (URI Fragments within 302 Location URI are lost over HTTPS)\n\t\t// Loading the redirect.html before triggering the OAuth Flow seems to fix it.\n\t\t//\n\t\t// Firefox  decodes URL fragments when calling location.hash.\n\t\t//  - This is bad if the value contains break points which are escaped\n\t\t//  - Hence the url must be encoded twice as it contains breakpoints.\n\t\tif (navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1) {\n\t\t\turl = redirectUri + '#oauth_redirect=' + encodeURIComponent(encodeURIComponent(url));\n\t\t}\n\n\t\treturn open(url);\n\t},\n\n\t// OAuth and API response handler\n\tresponseHandler: function(window, parent) {\n\n\t\tvar _this = this;\n\t\tvar p;\n\t\tvar location = window.location;\n\n\t\t// Is this an auth relay message which needs to call the proxy?\n\t\tp = _this.param(location.search);\n\n\t\t// OAuth2 or OAuth1 server response?\n\t\tif (p && ((p.code && p.state) || (p.oauth_token && p.proxy_url))) {\n\n\t\t\tvar state = JSON.parse(p.state);\n\n\t\t\t// Add this path as the redirect_uri\n\t\t\tp.redirect_uri = state.redirect_uri || location.href.replace(/[\\?\\#].*$/, '');\n\n\t\t\t// Redirect to the host\n\t\t\tvar path = (state.oauth_proxy || p.proxy_url) + '?' + _this.param(p);\n\n\t\t\tlocation.assign(path);\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Save session, from redirected authentication\n\t\t// #access_token has come in?\n\t\t//\n\t\t// FACEBOOK is returning auth errors within as a query_string... thats a stickler for consistency.\n\t\t// SoundCloud is the state in the querystring and the token in the hashtag, so we'll mix the two together\n\n\t\tp = _this.merge(_this.param(location.search || ''), _this.param(location.hash || ''));\n\n\t\t// If p.state\n\t\tif (p && 'state' in p) {\n\n\t\t\t// Remove any addition information\n\t\t\t// E.g. p.state = 'facebook.page';\n\t\t\ttry {\n\t\t\t\tvar a = JSON.parse(p.state);\n\t\t\t\t_this.extend(p, a);\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tconsole.error('Could not decode state parameter');\n\t\t\t}\n\n\t\t\t// Access_token?\n\t\t\tif (('access_token' in p && p.access_token) && p.network) {\n\n\t\t\t\tif (!p.expires_in || parseInt(p.expires_in, 10) === 0) {\n\t\t\t\t\t// If p.expires_in is unset, set to 0\n\t\t\t\t\tp.expires_in = 0;\n\t\t\t\t}\n\n\t\t\t\tp.expires_in = parseInt(p.expires_in, 10);\n\t\t\t\tp.expires = ((new Date()).getTime() / 1e3) + (p.expires_in || (60 * 60 * 24 * 365));\n\n\t\t\t\t// Lets use the \"state\" to assign it to one of our networks\n\t\t\t\tauthCallback(p, window, parent);\n\t\t\t}\n\n\t\t\t// Error=?\n\t\t\t// &error_description=?\n\t\t\t// &state=?\n\t\t\telse if (('error' in p && p.error) && p.network) {\n\n\t\t\t\tp.error = {\n\t\t\t\t\tcode: p.error,\n\t\t\t\t\tmessage: p.error_message || p.error_description\n\t\t\t\t};\n\n\t\t\t\t// Let the state handler handle it\n\t\t\t\tauthCallback(p, window, parent);\n\t\t\t}\n\n\t\t\t// API call, or a cancelled login\n\t\t\t// Result is serialized JSON string\n\t\t\telse if (p.callback && p.callback in parent) {\n\n\t\t\t\t// Trigger a function in the parent\n\t\t\t\tvar res = 'result' in p && p.result ? JSON.parse(p.result) : false;\n\n\t\t\t\t// Trigger the callback on the parent\n\t\t\t\tparent[p.callback](res);\n\t\t\t\tcloseWindow();\n\t\t\t}\n\n\t\t\t// If this page is still open\n\t\t\tif (p.page_uri) {\n\t\t\t\tlocation.assign(p.page_uri);\n\t\t\t}\n\t\t}\n\n\t\t// OAuth redirect, fixes URI fragments from being lost in Safari\n\t\t// (URI Fragments within 302 Location URI are lost over HTTPS)\n\t\t// Loading the redirect.html before triggering the OAuth Flow seems to fix it.\n\t\telse if ('oauth_redirect' in p) {\n\n\t\t\tlocation.assign(decodeURIComponent(p.oauth_redirect));\n\t\t\treturn;\n\t\t}\n\n\t\t// Trigger a callback to authenticate\n\t\tfunction authCallback(obj, window, parent) {\n\n\t\t\t// Trigger the callback on the parent\n\t\t\t_this.store(obj.network, obj);\n\n\t\t\t// If this is a page request it has no parent or opener window to handle callbacks\n\t\t\tif (('display' in obj) && obj.display === 'page') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (parent) {\n\t\t\t\t// Call the generic listeners\n\t\t\t\t// Win.hello.emit(network+\":auth.\"+(obj.error?'failed':'login'), obj);\n\n\t\t\t\t// TODO: remove from session object\n\t\t\t\tvar cb = obj.callback;\n\t\t\t\ttry {\n\t\t\t\t\tdelete obj.callback;\n\t\t\t\t}\n\t\t\t\tcatch (e) {}\n\n\t\t\t\t// Update store\n\t\t\t\t_this.store(obj.network, obj);\n\n\t\t\t\t// Call the globalEvent function on the parent\n\t\t\t\tif (cb in parent) {\n\n\t\t\t\t\t// It's safer to pass back a string to the parent,\n\t\t\t\t\t// Rather than an object/array (better for IE8)\n\t\t\t\t\tvar str = JSON.stringify(obj);\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tparent[cb](str);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (e) {\n\t\t\t\t\t\t// Error thrown whilst executing parent callback\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcloseWindow();\n\t\t}\n\n\t\tfunction closeWindow() {\n\n\t\t\t// Close this current window\n\t\t\ttry {\n\t\t\t\twindow.close();\n\t\t\t}\n\t\t\tcatch (e) {}\n\n\t\t\t// IOS bug wont let us close a popup if still loading\n\t\t\tif (window.addEventListener) {\n\t\t\t\twindow.addEventListener('load', function() {\n\t\t\t\t\twindow.close();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Events\n\n// Extend the hello object with its own event instance\nhello.utils.Event.call(hello);\n\n/////////////////////////////////////\n//\n// Save any access token that is in the current page URL\n// Handle any response solicited through iframe hash tag following an API request\n//\n/////////////////////////////////////\n\nhello.utils.responseHandler(window, window.opener || window.parent);\n\n///////////////////////////////////\n// Monitoring session state\n// Check for session changes\n///////////////////////////////////\n\n(function(hello) {\n\n\t// Monitor for a change in state and fire\n\tvar oldSessions = {};\n\n\t// Hash of expired tokens\n\tvar expired = {};\n\n\t// Listen to other triggers to Auth events, use these to update this\n\thello.on('auth.login, auth.logout', function(auth) {\n\t\tif (auth && typeof (auth) === 'object' && auth.network) {\n\t\t\toldSessions[auth.network] = hello.utils.store(auth.network) || {};\n\t\t}\n\t});\n\n\t(function self() {\n\n\t\tvar CURRENT_TIME = ((new Date()).getTime() / 1e3);\n\t\tvar emit = function(eventName) {\n\t\t\thello.emit('auth.' + eventName, {\n\t\t\t\tnetwork: name,\n\t\t\t\tauthResponse: session\n\t\t\t});\n\t\t};\n\n\t\t// Loop through the services\n\t\tfor (var name in hello.services) {if (hello.services.hasOwnProperty(name)) {\n\n\t\t\tif (!hello.services[name].id) {\n\t\t\t\t// We haven't attached an ID so dont listen.\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Get session\n\t\t\tvar session = hello.utils.store(name) || {};\n\t\t\tvar provider = hello.services[name];\n\t\t\tvar oldSess = oldSessions[name] || {};\n\n\t\t\t// Listen for globalEvents that did not get triggered from the child\n\t\t\tif (session && 'callback' in session) {\n\n\t\t\t\t// To do remove from session object...\n\t\t\t\tvar cb = session.callback;\n\t\t\t\ttry {\n\t\t\t\t\tdelete session.callback;\n\t\t\t\t}\n\t\t\t\tcatch (e) {}\n\n\t\t\t\t// Update store\n\t\t\t\t// Removing the callback\n\t\t\t\thello.utils.store(name, session);\n\n\t\t\t\t// Emit global events\n\t\t\t\ttry {\n\t\t\t\t\twindow[cb](session);\n\t\t\t\t}\n\t\t\t\tcatch (e) {}\n\t\t\t}\n\n\t\t\t// Refresh token\n\t\t\tif (session && ('expires' in session) && session.expires < CURRENT_TIME) {\n\n\t\t\t\t// If auto refresh is possible\n\t\t\t\t// Either the browser supports\n\t\t\t\tvar refresh = provider.refresh || session.refresh_token;\n\n\t\t\t\t// Has the refresh been run recently?\n\t\t\t\tif (refresh && (!(name in expired) || expired[name] < CURRENT_TIME)) {\n\t\t\t\t\t// Try to resignin\n\t\t\t\t\thello.emit('notice', name + ' has expired trying to resignin');\n\t\t\t\t\thello.login(name, {display: 'none', force: false});\n\n\t\t\t\t\t// Update expired, every 10 minutes\n\t\t\t\t\texpired[name] = CURRENT_TIME + 600;\n\t\t\t\t}\n\n\t\t\t\t// Does this provider not support refresh\n\t\t\t\telse if (!refresh && !(name in expired)) {\n\t\t\t\t\t// Label the event\n\t\t\t\t\temit('expired');\n\t\t\t\t\texpired[name] = true;\n\t\t\t\t}\n\n\t\t\t\t// If session has expired then we dont want to store its value until it can be established that its been updated\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Has session changed?\n\t\t\telse if (oldSess.access_token === session.access_token &&\n\t\t\toldSess.expires === session.expires) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Access_token has been removed\n\t\t\telse if (!session.access_token && oldSess.access_token) {\n\t\t\t\temit('logout');\n\t\t\t}\n\n\t\t\t// Access_token has been created\n\t\t\telse if (session.access_token && !oldSess.access_token) {\n\t\t\t\temit('login');\n\t\t\t}\n\n\t\t\t// Access_token has been updated\n\t\t\telse if (session.expires !== oldSess.expires) {\n\t\t\t\temit('update');\n\t\t\t}\n\n\t\t\t// Updated stored session\n\t\t\toldSessions[name] = session;\n\n\t\t\t// Remove the expired flags\n\t\t\tif (name in expired) {\n\t\t\t\tdelete expired[name];\n\t\t\t}\n\t\t}}\n\n\t\t// Check error events\n\t\tsetTimeout(self, 1000);\n\t})();\n\n})(hello);\n\n// EOF CORE lib\n//////////////////////////////////\n\n/////////////////////////////////////////\n// API\n// @param path    string\n// @param query   object (optional)\n// @param method  string (optional)\n// @param data    object (optional)\n// @param timeout integer (optional)\n// @param callback  function (optional)\n\nhello.api = function() {\n\n\t// Shorthand\n\tvar _this = this;\n\tvar utils = _this.utils;\n\n\t// Construct a new Promise object\n\tvar promise = utils.Promise();\n\n\t// Arguments\n\tvar p = utils.args({path: 's!', query: 'o', method: 's', data: 'o', timeout: 'i', callback: 'f'}, arguments);\n\n\t// Method\n\tp.method = (p.method || 'get').toLowerCase();\n\n\t// Headers\n\tp.headers = p.headers || {};\n\n\t// Query\n\tp.query = p.query || {};\n\n\t// If get, put all parameters into query\n\tif (p.method === 'get' || p.method === 'delete') {\n\t\tutils.extend(p.query, p.data);\n\t\tp.data = {};\n\t}\n\n\tvar data = p.data = p.data || {};\n\n\t// Completed event callback\n\tpromise.then(p.callback, p.callback);\n\n\t// Remove the network from path, e.g. facebook:/me/friends\n\t// Results in { network : facebook, path : me/friends }\n\tif (!p.path) {\n\t\treturn promise.reject(error('invalid_path', 'Missing the path parameter from the request'));\n\t}\n\n\tp.path = p.path.replace(/^\\/+/, '');\n\tvar a = (p.path.split(/[\\/\\:]/, 2) || [])[0].toLowerCase();\n\n\tif (a in _this.services) {\n\t\tp.network = a;\n\t\tvar reg = new RegExp('^' + a + ':?\\/?');\n\t\tp.path = p.path.replace(reg, '');\n\t}\n\n\t// Network & Provider\n\t// Define the network that this request is made for\n\tp.network = _this.settings.default_service = p.network || _this.settings.default_service;\n\tvar o = _this.services[p.network];\n\n\t// INVALID\n\t// Is there no service by the given network name?\n\tif (!o) {\n\t\treturn promise.reject(error('invalid_network', 'Could not match the service requested: ' + p.network));\n\t}\n\n\t// PATH\n\t// As long as the path isn't flagged as unavaiable, e.g. path == false\n\n\tif (!(!(p.method in o) || !(p.path in o[p.method]) || o[p.method][p.path] !== false)) {\n\t\treturn promise.reject(error('invalid_path', 'The provided path is not available on the selected network'));\n\t}\n\n\t// PROXY\n\t// OAuth1 calls always need a proxy\n\n\tif (!p.oauth_proxy) {\n\t\tp.oauth_proxy = _this.settings.oauth_proxy;\n\t}\n\n\tif (!('proxy' in p)) {\n\t\tp.proxy = p.oauth_proxy && o.oauth && parseInt(o.oauth.version, 10) === 1;\n\t}\n\n\t// TIMEOUT\n\t// Adopt timeout from global settings by default\n\n\tif (!('timeout' in p)) {\n\t\tp.timeout = _this.settings.timeout;\n\t}\n\n\t//\n\t// Get the current session\n\t// Append the access_token to the query\n\tvar session = _this.getAuthResponse(p.network);\n\tif (session && session.access_token) {\n\t\tp.query.access_token = session.access_token;\n\t}\n\n\tvar url = p.path;\n\tvar m;\n\n\t// Store the query as options\n\t// This is used to populate the request object before the data is augmented by the prewrap handlers.\n\tp.options = utils.clone(p.query);\n\n\t// Clone the data object\n\t// Prevent this script overwriting the data of the incoming object.\n\t// Ensure that everytime we run an iteration the callbacks haven't removed some data\n\tp.data = utils.clone(data);\n\n\t// URL Mapping\n\t// Is there a map for the given URL?\n\tvar actions = o[{'delete': 'del'}[p.method] || p.method] || {};\n\n\t// Extrapolate the QueryString\n\t// Provide a clean path\n\t// Move the querystring into the data\n\tif (p.method === 'get') {\n\n\t\tvar query = url.split(/[\\?#]/)[1];\n\t\tif (query) {\n\t\t\tutils.extend(p.query, utils.param(query));\n\n\t\t\t// Remove the query part from the URL\n\t\t\turl = url.replace(/\\?.*?(#|$)/, '$1');\n\t\t}\n\t}\n\n\t// Is the hash fragment defined\n\tif ((m = url.match(/#(.+)/, ''))) {\n\t\turl = url.split('#')[0];\n\t\tp.path = m[1];\n\t}\n\telse if (url in actions) {\n\t\tp.path = url;\n\t\turl = actions[url];\n\t}\n\telse if ('default' in actions) {\n\t\turl = actions['default'];\n\t}\n\n\t// Redirect Handler\n\t// This defines for the Form+Iframe+Hash hack where to return the results too.\n\tp.redirect_uri = _this.settings.redirect_uri;\n\n\t// Set OAuth settings\n\tp.oauth = o.oauth;\n\n\t// Define FormatHandler\n\t// The request can be procesed in a multitude of ways\n\t// Here's the options - depending on the browser and endpoint\n\tp.xhr = o.xhr;\n\tp.jsonp = o.jsonp;\n\tp.form = o.form;\n\n\t// Make request\n\tif (typeof (url) === 'function') {\n\t\t// Does self have its own callback?\n\t\turl(p, getPath);\n\t}\n\telse {\n\t\t// Else the URL is a string\n\t\tgetPath(url);\n\t}\n\n\treturn promise.proxy;\n\n\t// If url needs a base\n\t// Wrap everything in\n\tfunction getPath(url) {\n\n\t\t// Format the string if it needs it\n\t\turl = url.replace(/\\@\\{([a-z\\_\\-]+)(\\|.+?)?\\}/gi, function(m, key, defaults) {\n\t\t\tvar val = defaults ? defaults.replace(/^\\|/, '') : '';\n\t\t\tif (key in p.query) {\n\t\t\t\tval = p.query[key];\n\t\t\t\tdelete p.query[key];\n\t\t\t}\n\t\t\telse if (!defaults) {\n\t\t\t\tpromise.reject(error('missing_attribute', 'The attribute ' + key + ' is missing from the request'));\n\t\t\t}\n\n\t\t\treturn val;\n\t\t});\n\n\t\t// Add base\n\t\tif (!url.match(/^https?:\\/\\//)) {\n\t\t\turl = o.base + url;\n\t\t}\n\n\t\t// Define the request URL\n\t\tp.url = url;\n\n\t\t// Make the HTTP request with the curated request object\n\t\t// CALLBACK HANDLER\n\t\t// @ response object\n\t\t// @ statusCode integer if available\n\t\tutils.request(p, function(r, headers) {\n\n\t\t\t// Should this be an object\n\t\t\tif (r === true) {\n\t\t\t\tr = {success:true};\n\t\t\t}\n\t\t\telse if (!r) {\n\t\t\t\tr = {};\n\t\t\t}\n\n\t\t\t// The delete callback needs a better response\n\t\t\tif (p.method === 'delete') {\n\t\t\t\tr = (!r || utils.isEmpty(r)) ? {success:true} : r;\n\t\t\t}\n\n\t\t\t// FORMAT RESPONSE?\n\t\t\t// Does self request have a corresponding formatter\n\t\t\tif (o.wrap && ((p.path in o.wrap) || ('default' in o.wrap))) {\n\t\t\t\tvar wrap = (p.path in o.wrap ? p.path : 'default');\n\t\t\t\tvar time = (new Date()).getTime();\n\n\t\t\t\t// FORMAT RESPONSE\n\t\t\t\tvar b = o.wrap[wrap](r, headers, p);\n\n\t\t\t\t// Has the response been utterly overwritten?\n\t\t\t\t// Typically self augments the existing object.. but for those rare occassions\n\t\t\t\tif (b) {\n\t\t\t\t\tr = b;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Is there a next_page defined in the response?\n\t\t\tif (r && 'paging' in r && r.paging.next) {\n\n\t\t\t\t// Add the relative path if it is missing from the paging/next path\n\t\t\t\tif (r.paging.next[0] === '?') {\n\t\t\t\t\tr.paging.next = p.path + r.paging.next;\n\t\t\t\t}\n\n\t\t\t\t// The relative path has been defined, lets markup the handler in the HashFragment\n\t\t\t\telse {\n\t\t\t\t\tr.paging.next += '#' + p.path;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Dispatch to listeners\n\t\t\t// Emit events which pertain to the formatted response\n\t\t\tif (!r || 'error' in r) {\n\t\t\t\tpromise.reject(r);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpromise.fulfill(r);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Error handling\n\tfunction error(code, message) {\n\t\treturn {\n\t\t\terror:{\n\t\t\t\tcode:code,\n\t\t\t\tmessage:message\n\t\t\t}\n\t\t};\n\t}\n\n};\n\n// API utilities\nhello.utils.extend(hello.utils, {\n\n\t// Make an HTTP request\n\trequest: function(p, callback) {\n\n\t\tvar _this = this;\n\n\t\t// This has to go through a POST request\n\t\tif (!_this.isEmpty(p.data) && !('FileList' in window) && _this.hasBinary(p.data)) {\n\n\t\t\t// Disable XHR and JSONP\n\t\t\tp.xhr = false;\n\t\t\tp.jsonp = false;\n\t\t}\n\n\t\t// Check if the browser and service support CORS\n\t\tif (\n\t\t\t'withCredentials' in new XMLHttpRequest() &&\n\t\t\t(!('xhr' in p) || (p.xhr && (typeof (p.xhr) !== 'function' || p.xhr(p, p.query))))\n\t\t) {\n\n\t\t\tformatUrl(p, function(url) {\n\n\t\t\t\tvar x = _this.xhr(p.method, url, p.headers, p.data, callback);\n\t\t\t\tx.onprogress = p.onprogress || null;\n\n\t\t\t\t// Windows Phone does not support xhr.upload, see #74\n\t\t\t\t// Feature detect\n\t\t\t\tif (x.upload && p.onuploadprogress) {\n\t\t\t\t\tx.upload.onprogress = p.onuploadprogress;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Clone the query object\n\t\t// Each request modifies the query object and needs to be tared after each one.\n\t\tvar _query = p.query;\n\n\t\tp.query = _this.clone(p.query);\n\n\t\t// Assign a new callbackID\n\t\tp.callbackID = _this.globalEvent();\n\n\t\t// JSONP\n\t\tif (p.jsonp !== false) {\n\n\t\t\t// Clone the query object\n\t\t\tp.query.callback = p.callbackID;\n\n\t\t\t// If the JSONP is a function then run it\n\t\t\tif (typeof (p.jsonp) === 'function') {\n\t\t\t\tp.jsonp(p, p.query);\n\t\t\t}\n\n\t\t\t// Lets use JSONP if the method is 'get'\n\t\t\tif (p.method === 'get') {\n\n\t\t\t\tformatUrl(p, function(url) {\n\t\t\t\t\t_this.jsonp(url, callback, p.callbackID, p.timeout);\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// It's not compatible reset query\n\t\t\t\tp.query = _query;\n\t\t\t}\n\n\t\t}\n\n\t\t// Otherwise we're on to the old school, iframe hacks and JSONP\n\t\tif (p.form !== false) {\n\n\t\t\t// Add some additional query parameters to the URL\n\t\t\t// We're pretty stuffed if the endpoint doesn't like these\n\t\t\tp.query.redirect_uri = p.redirect_uri;\n\t\t\tp.query.state = JSON.stringify({callback:p.callbackID});\n\n\t\t\tvar opts;\n\n\t\t\tif (typeof (p.form) === 'function') {\n\n\t\t\t\t// Format the request\n\t\t\t\topts = p.form(p, p.query);\n\t\t\t}\n\n\t\t\tif (p.method === 'post' && opts !== false) {\n\n\t\t\t\tformatUrl(p, function(url) {\n\t\t\t\t\t_this.post(url, p.data, opts, callback, p.callbackID, p.timeout);\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// None of the methods were successful throw an error\n\t\tcallback({\n\t\t\terror:{\n\t\t\t\tcode: 'invalid_request',\n\t\t\t\tmessage: 'There was no mechanism for handling this request'\n\t\t\t}\n\t\t});\n\n\t\treturn;\n\n\t\t// Format URL\n\t\t// Constructs the request URL, optionally wraps the URL through a call to a proxy server\n\t\t// Returns the formatted URL\n\t\tfunction formatUrl(p, callback) {\n\n\t\t\t// Are we signing the request?\n\t\t\tvar sign;\n\n\t\t\t// OAuth1\n\t\t\t// Remove the token from the query before signing\n\t\t\tif (p.oauth && parseInt(p.oauth.version, 10) === 1) {\n\n\t\t\t\t// OAUTH SIGNING PROXY\n\t\t\t\tsign = p.query.access_token;\n\n\t\t\t\t// Remove the access_token\n\t\t\t\tdelete p.query.access_token;\n\n\t\t\t\t// Enfore use of Proxy\n\t\t\t\tp.proxy = true;\n\t\t\t}\n\n\t\t\t// POST body to querystring\n\t\t\tif (p.data && (p.method === 'get' || p.method === 'delete')) {\n\t\t\t\t// Attach the p.data to the querystring.\n\t\t\t\t_this.extend(p.query, p.data);\n\t\t\t\tp.data = null;\n\t\t\t}\n\n\t\t\t// Construct the path\n\t\t\tvar path = _this.qs(p.url, p.query);\n\n\t\t\t// Proxy the request through a server\n\t\t\t// Used for signing OAuth1\n\t\t\t// And circumventing services without Access-Control Headers\n\t\t\tif (p.proxy) {\n\t\t\t\t// Use the proxy as a path\n\t\t\t\tpath = _this.qs(p.oauth_proxy, {\n\t\t\t\t\tpath: path,\n\t\t\t\t\taccess_token: sign || '',\n\n\t\t\t\t\t// This will prompt the request to be signed as though it is OAuth1\n\t\t\t\t\tthen: p.proxy_response_type || (p.method.toLowerCase() === 'get' ? 'redirect' : 'proxy'),\n\t\t\t\t\tmethod: p.method.toLowerCase(),\n\t\t\t\t\tsuppress_response_codes: true\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tcallback(path);\n\t\t}\n\t},\n\n\t// Return the type of DOM object\n\tdomInstance: function(type, data) {\n\t\tvar test = 'HTML' + (type || '').replace(\n\t\t\t/^[a-z]/,\n\t\t\tfunction(m) {\n\t\t\t\treturn m.toUpperCase();\n\t\t\t}\n\n\t\t) + 'Element';\n\n\t\tif (!data) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (window[test]) {\n\t\t\treturn data instanceof window[test];\n\t\t}\n\t\telse if (window.Element) {\n\t\t\treturn data instanceof window.Element && (!type || (data.tagName && data.tagName.toLowerCase() === type));\n\t\t}\n\t\telse {\n\t\t\treturn (!(data instanceof Object || data instanceof Array || data instanceof String || data instanceof Number) && data.tagName && data.tagName.toLowerCase() === type);\n\t\t}\n\t},\n\n\t// Create a clone of an object\n\tclone: function(obj) {\n\t\t// Does not clone DOM elements, nor Binary data, e.g. Blobs, Filelists\n\t\tif (obj === null || typeof (obj) !== 'object' || obj instanceof Date || 'nodeName' in obj || this.isBinary(obj)) {\n\t\t\treturn obj;\n\t\t}\n\n\t\tif (Array.isArray(obj)) {\n\t\t\t// Clone each item in the array\n\t\t\treturn obj.map(this.clone);\n\t\t}\n\n\t\t// But does clone everything else.\n\t\tvar clone = {};\n\t\tfor (var x in obj) {\n\t\t\tclone[x] = this.clone(obj[x]);\n\t\t}\n\n\t\treturn clone;\n\t},\n\n\t// XHR: uses CORS to make requests\n\txhr: function(method, url, headers, data, callback) {\n\n\t\tvar r = new XMLHttpRequest();\n\n\t\t// Binary?\n\t\tvar binary = false;\n\t\tif (method === 'blob') {\n\t\t\tbinary = method;\n\t\t\tmethod = 'GET';\n\t\t}\n\n\t\tmethod = method.toUpperCase();\n\n\t\t// Xhr.responseType 'json' is not supported in any of the vendors yet.\n\t\tr.onload = function(e) {\n\t\t\tvar json = r.response;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse(r.responseText);\n\t\t\t}\n\t\t\tcatch (_e) {\n\t\t\t\tif (r.status === 401) {\n\t\t\t\t\tjson = {\n\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\tcode: 'access_denied',\n\t\t\t\t\t\t\tmessage: r.statusText\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar headers = headersToJSON(r.getAllResponseHeaders());\n\t\t\theaders.statusCode = r.status;\n\n\t\t\tcallback(json || (method === 'GET' ? {error:{code: 'empty_response', message: 'Could not get resource'}} : {}), headers);\n\t\t};\n\n\t\tr.onerror = function(e) {\n\t\t\tvar json = r.responseText;\n\t\t\ttry {\n\t\t\t\tjson = JSON.parse(r.responseText);\n\t\t\t}\n\t\t\tcatch (_e) {}\n\n\t\t\tcallback(json || {error: {\n\t\t\t\tcode: 'access_denied',\n\t\t\t\tmessage: 'Could not get resource'\n\t\t\t}});\n\t\t};\n\n\t\tvar x;\n\n\t\t// Should we add the query to the URL?\n\t\tif (method === 'GET' || method === 'DELETE') {\n\t\t\tdata = null;\n\t\t}\n\t\telse if (data && typeof (data) !== 'string' && !(data instanceof FormData) && !(data instanceof File) && !(data instanceof Blob)) {\n\t\t\t// Loop through and add formData\n\t\t\tvar f = new FormData();\n\t\t\tfor (x in data) if (data.hasOwnProperty(x)) {\n\t\t\t\tif (data[x] instanceof HTMLInputElement) {\n\t\t\t\t\tif ('files' in data[x] && data[x].files.length > 0) {\n\t\t\t\t\t\tf.append(x, data[x].files[0]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (data[x] instanceof Blob) {\n\t\t\t\t\tf.append(x, data[x], data.name);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tf.append(x, data[x]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata = f;\n\t\t}\n\n\t\t// Open the path, async\n\t\tr.open(method, url, true);\n\n\t\tif (binary) {\n\t\t\tif ('responseType' in r) {\n\t\t\t\tr.responseType = binary;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tr.overrideMimeType('text/plain; charset=x-user-defined');\n\t\t\t}\n\t\t}\n\n\t\t// Set any bespoke headers\n\t\tif (headers) {\n\t\t\tfor (x in headers) {\n\t\t\t\tr.setRequestHeader(x, headers[x]);\n\t\t\t}\n\t\t}\n\n\t\tr.send(data);\n\n\t\treturn r;\n\n\t\t// Headers are returned as a string\n\t\tfunction headersToJSON(s) {\n\t\t\tvar r = {};\n\t\t\tvar reg = /([a-z\\-]+):\\s?(.*);?/gi;\n\t\t\tvar m;\n\t\t\twhile ((m = reg.exec(s))) {\n\t\t\t\tr[m[1]] = m[2];\n\t\t\t}\n\n\t\t\treturn r;\n\t\t}\n\t},\n\n\t// JSONP\n\t// Injects a script tag into the DOM to be executed and appends a callback function to the window object\n\t// @param string/function pathFunc either a string of the URL or a callback function pathFunc(querystringhash, continueFunc);\n\t// @param function callback a function to call on completion;\n\tjsonp: function(url, callback, callbackID, timeout) {\n\n\t\tvar _this = this;\n\n\t\t// Change the name of the callback\n\t\tvar bool = 0;\n\t\tvar head = document.getElementsByTagName('head')[0];\n\t\tvar operaFix;\n\t\tvar result = {error: {message: 'server_error', code: 'server_error'}};\n\t\tvar cb = function() {\n\t\t\tif (!(bool++)) {\n\t\t\t\twindow.setTimeout(function() {\n\t\t\t\t\tcallback(result);\n\t\t\t\t\thead.removeChild(script);\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t};\n\n\t\t// Add callback to the window object\n\t\tcallbackID = _this.globalEvent(function(json) {\n\t\t\tresult = json;\n\t\t\treturn true;\n\n\t\t\t// Mark callback as done\n\t\t}, callbackID);\n\n\t\t// The URL is a function for some cases and as such\n\t\t// Determine its value with a callback containing the new parameters of this function.\n\t\turl = url.replace(new RegExp('=\\\\?(&|$)'), '=' + callbackID + '$1');\n\n\t\t// Build script tag\n\t\tvar script = _this.append('script', {\n\t\t\tid: callbackID,\n\t\t\tname: callbackID,\n\t\t\tsrc: url,\n\t\t\tasync: true,\n\t\t\tonload: cb,\n\t\t\tonerror: cb,\n\t\t\tonreadystatechange: function() {\n\t\t\t\tif (/loaded|complete/i.test(this.readyState)) {\n\t\t\t\t\tcb();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Opera fix error\n\t\t// Problem: If an error occurs with script loading Opera fails to trigger the script.onerror handler we specified\n\t\t//\n\t\t// Fix:\n\t\t// By setting the request to synchronous we can trigger the error handler when all else fails.\n\t\t// This action will be ignored if we've already called the callback handler \"cb\" with a successful onload event\n\t\tif (window.navigator.userAgent.toLowerCase().indexOf('opera') > -1) {\n\t\t\toperaFix = _this.append('script', {\n\t\t\t\ttext: 'document.getElementById(\\'' + callbackId + '\\').onerror();'\n\t\t\t});\n\t\t\tscript.async = false;\n\t\t}\n\n\t\t// Add timeout\n\t\tif (timeout) {\n\t\t\twindow.setTimeout(function() {\n\t\t\t\tresult = {error: {message: 'timeout', code: 'timeout'}};\n\t\t\t\tcb();\n\t\t\t}, timeout);\n\t\t}\n\n\t\t// TODO: add fix for IE,\n\t\t// However: unable recreate the bug of firing off the onreadystatechange before the script content has been executed and the value of \"result\" has been defined.\n\t\t// Inject script tag into the head element\n\t\thead.appendChild(script);\n\n\t\t// Append Opera Fix to run after our script\n\t\tif (operaFix) {\n\t\t\thead.appendChild(operaFix);\n\t\t}\n\t},\n\n\t// Post\n\t// Send information to a remote location using the post mechanism\n\t// @param string uri path\n\t// @param object data, key value data to send\n\t// @param function callback, function to execute in response\n\tpost: function(url, data, options, callback, callbackID, timeout) {\n\n\t\tvar _this = this;\n\t\tvar doc = document;\n\n\t\t// This hack needs a form\n\t\tvar form = null;\n\t\tvar reenableAfterSubmit = [];\n\t\tvar newform;\n\t\tvar i = 0;\n\t\tvar x = null;\n\t\tvar bool = 0;\n\t\tvar cb = function(r) {\n\t\t\tif (!(bool++)) {\n\t\t\t\tcallback(r);\n\t\t\t}\n\t\t};\n\n\t\t// What is the name of the callback to contain\n\t\t// We'll also use this to name the iframe\n\t\t_this.globalEvent(cb, callbackID);\n\n\t\t// Build the iframe window\n\t\tvar win;\n\t\ttry {\n\t\t\t// IE7 hack, only lets us define the name here, not later.\n\t\t\twin = doc.createElement('<iframe name=\"' + callbackID + '\">');\n\t\t}\n\t\tcatch (e) {\n\t\t\twin = doc.createElement('iframe');\n\t\t}\n\n\t\twin.name = callbackID;\n\t\twin.id = callbackID;\n\t\twin.style.display = 'none';\n\n\t\t// Override callback mechanism. Triggger a response onload/onerror\n\t\tif (options && options.callbackonload) {\n\t\t\t// Onload is being fired twice\n\t\t\twin.onload = function() {\n\t\t\t\tcb({\n\t\t\t\t\tresponse: 'posted',\n\t\t\t\t\tmessage: 'Content was posted'\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\n\t\tif (timeout) {\n\t\t\tsetTimeout(function() {\n\t\t\t\tcb({\n\t\t\t\t\terror: {\n\t\t\t\t\t\tcode: 'timeout',\n\t\t\t\t\t\tmessage: 'The post operation timed out'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, timeout);\n\t\t}\n\n\t\tdoc.body.appendChild(win);\n\n\t\t// If we are just posting a single item\n\t\tif (_this.domInstance('form', data)) {\n\t\t\t// Get the parent form\n\t\t\tform = data.form;\n\n\t\t\t// Loop through and disable all of its siblings\n\t\t\tfor (i = 0; i < form.elements.length; i++) {\n\t\t\t\tif (form.elements[i] !== data) {\n\t\t\t\t\tform.elements[i].setAttribute('disabled', true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Move the focus to the form\n\t\t\tdata = form;\n\t\t}\n\n\t\t// Posting a form\n\t\tif (_this.domInstance('form', data)) {\n\t\t\t// This is a form element\n\t\t\tform = data;\n\n\t\t\t// Does this form need to be a multipart form?\n\t\t\tfor (i = 0; i < form.elements.length; i++) {\n\t\t\t\tif (!form.elements[i].disabled && form.elements[i].type === 'file') {\n\t\t\t\t\tform.encoding = form.enctype = 'multipart/form-data';\n\t\t\t\t\tform.elements[i].setAttribute('name', 'file');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\t// Its not a form element,\n\t\t\t// Therefore it must be a JSON object of Key=>Value or Key=>Element\n\t\t\t// If anyone of those values are a input type=file we shall shall insert its siblings into the form for which it belongs.\n\t\t\tfor (x in data) if (data.hasOwnProperty(x)) {\n\t\t\t\t// Is this an input Element?\n\t\t\t\tif (_this.domInstance('input', data[x]) && data[x].type === 'file') {\n\t\t\t\t\tform = data[x].form;\n\t\t\t\t\tform.encoding = form.enctype = 'multipart/form-data';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Do If there is no defined form element, lets create one.\n\t\t\tif (!form) {\n\t\t\t\t// Build form\n\t\t\t\tform = doc.createElement('form');\n\t\t\t\tdoc.body.appendChild(form);\n\t\t\t\tnewform = form;\n\t\t\t}\n\n\t\t\tvar input;\n\n\t\t\t// Add elements to the form if they dont exist\n\t\t\tfor (x in data) if (data.hasOwnProperty(x)) {\n\n\t\t\t\t// Is this an element?\n\t\t\t\tvar el = (_this.domInstance('input', data[x]) || _this.domInstance('textArea', data[x]) || _this.domInstance('select', data[x]));\n\n\t\t\t\t// Is this not an input element, or one that exists outside the form.\n\t\t\t\tif (!el || data[x].form !== form) {\n\n\t\t\t\t\t// Does an element have the same name?\n\t\t\t\t\tvar inputs = form.elements[x];\n\t\t\t\t\tif (input) {\n\t\t\t\t\t\t// Remove it.\n\t\t\t\t\t\tif (!(inputs instanceof NodeList)) {\n\t\t\t\t\t\t\tinputs = [inputs];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (i = 0; i < inputs.length; i++) {\n\t\t\t\t\t\t\tinputs[i].parentNode.removeChild(inputs[i]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create an input element\n\t\t\t\t\tinput = doc.createElement('input');\n\t\t\t\t\tinput.setAttribute('type', 'hidden');\n\t\t\t\t\tinput.setAttribute('name', x);\n\n\t\t\t\t\t// Does it have a value attribute?\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tinput.value = data[x].value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (_this.domInstance(null, data[x])) {\n\t\t\t\t\t\tinput.value = data[x].innerHTML || data[x].innerText;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tinput.value = data[x];\n\t\t\t\t\t}\n\n\t\t\t\t\tform.appendChild(input);\n\t\t\t\t}\n\n\t\t\t\t// It is an element, which exists within the form, but the name is wrong\n\t\t\t\telse if (el && data[x].name !== x) {\n\t\t\t\t\tdata[x].setAttribute('name', x);\n\t\t\t\t\tdata[x].name = x;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Disable elements from within the form if they weren't specified\n\t\t\tfor (i = 0; i < form.elements.length; i++) {\n\n\t\t\t\tinput = form.elements[i];\n\n\t\t\t\t// Does the same name and value exist in the parent\n\t\t\t\tif (!(input.name in data) && input.getAttribute('disabled') !== true) {\n\t\t\t\t\t// Disable\n\t\t\t\t\tinput.setAttribute('disabled', true);\n\n\t\t\t\t\t// Add re-enable to callback\n\t\t\t\t\treenableAfterSubmit.push(input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Set the target of the form\n\t\tform.setAttribute('method', 'POST');\n\t\tform.setAttribute('target', callbackID);\n\t\tform.target = callbackID;\n\n\t\t// Update the form URL\n\t\tform.setAttribute('action', url);\n\n\t\t// Submit the form\n\t\t// Some reason this needs to be offset from the current window execution\n\t\tsetTimeout(function() {\n\t\t\tform.submit();\n\n\t\t\tsetTimeout(function() {\n\t\t\t\ttry {\n\t\t\t\t\t// Remove the iframe from the page.\n\t\t\t\t\t//win.parentNode.removeChild(win);\n\t\t\t\t\t// Remove the form\n\t\t\t\t\tif (newform) {\n\t\t\t\t\t\tnewform.parentNode.removeChild(newform);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.error('HelloJS: could not remove iframe');\n\t\t\t\t\t}\n\t\t\t\t\tcatch (ee) {}\n\t\t\t\t}\n\n\t\t\t\t// Reenable the disabled form\n\t\t\t\tfor (var i = 0; i < reenableAfterSubmit.length; i++) {\n\t\t\t\t\tif (reenableAfterSubmit[i]) {\n\t\t\t\t\t\treenableAfterSubmit[i].setAttribute('disabled', false);\n\t\t\t\t\t\treenableAfterSubmit[i].disabled = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 0);\n\t\t}, 100);\n\t},\n\n\t// Some of the providers require that only multipart is used with non-binary forms.\n\t// This function checks whether the form contains binary data\n\thasBinary: function(data) {\n\t\tfor (var x in data) if (data.hasOwnProperty(x)) {\n\t\t\tif (this.isBinary(data[x])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\n\t// Determines if a variable Either Is or like a FormInput has the value of a Blob\n\n\tisBinary: function(data) {\n\n\t\treturn data instanceof Object && (\n\t\t(this.domInstance('input', data) && data.type === 'file') ||\n\t\t('FileList' in window && data instanceof window.FileList) ||\n\t\t('File' in window && data instanceof window.File) ||\n\t\t('Blob' in window && data instanceof window.Blob));\n\n\t},\n\n\t// Convert Data-URI to Blob string\n\ttoBlob: function(dataURI) {\n\t\tvar reg = /^data\\:([^;,]+(\\;charset=[^;,]+)?)(\\;base64)?,/i;\n\t\tvar m = dataURI.match(reg);\n\t\tif (!m) {\n\t\t\treturn dataURI;\n\t\t}\n\n\t\tvar binary = atob(dataURI.replace(reg, ''));\n\t\tvar array = [];\n\t\tfor (var i = 0; i < binary.length; i++) {\n\t\t\tarray.push(binary.charCodeAt(i));\n\t\t}\n\n\t\treturn new Blob([new Uint8Array(array)], {type: m[1]});\n\t}\n\n});\n\n// EXTRA: Convert FormElement to JSON for POSTing\n// Wrappers to add additional functionality to existing functions\n(function(hello) {\n\n\t// Copy original function\n\tvar api = hello.api;\n\tvar utils = hello.utils;\n\n\tutils.extend(utils, {\n\n\t\t// DataToJSON\n\t\t// This takes a FormElement|NodeList|InputElement|MixedObjects and convers the data object to JSON.\n\t\tdataToJSON: function(p) {\n\n\t\t\tvar _this = this;\n\t\t\tvar w = window;\n\t\t\tvar data = p.data;\n\n\t\t\t// Is data a form object\n\t\t\tif (_this.domInstance('form', data)) {\n\t\t\t\tdata = _this.nodeListToJSON(data.elements);\n\t\t\t}\n\t\t\telse if ('NodeList' in w && data instanceof NodeList) {\n\t\t\t\tdata = _this.nodeListToJSON(data);\n\t\t\t}\n\t\t\telse if (_this.domInstance('input', data)) {\n\t\t\t\tdata = _this.nodeListToJSON([data]);\n\t\t\t}\n\n\t\t\t// Is data a blob, File, FileList?\n\t\t\tif (('File' in w && data instanceof w.File) ||\n\t\t\t\t('Blob' in w && data instanceof w.Blob) ||\n\t\t\t\t('FileList' in w && data instanceof w.FileList)) {\n\t\t\t\tdata = {file: data};\n\t\t\t}\n\n\t\t\t// Loop through data if it's not form data it must now be a JSON object\n\t\t\tif (!('FormData' in w && data instanceof w.FormData)) {\n\n\t\t\t\tfor (var x in data) if (data.hasOwnProperty(x)) {\n\n\t\t\t\t\tif ('FileList' in w && data[x] instanceof w.FileList) {\n\t\t\t\t\t\tif (data[x].length === 1) {\n\t\t\t\t\t\t\tdata[x] = data[x][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (_this.domInstance('input', data[x]) && data[x].type === 'file') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if (_this.domInstance('input', data[x]) ||\n\t\t\t\t\t\t_this.domInstance('select', data[x]) ||\n\t\t\t\t\t\t_this.domInstance('textArea', data[x])) {\n\t\t\t\t\t\tdata[x] = data[x].value;\n\t\t\t\t\t}\n\t\t\t\t\telse if (_this.domInstance(null, data[x])) {\n\t\t\t\t\t\tdata[x] = data[x].innerHTML || data[x].innerText;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tp.data = data;\n\t\t\treturn data;\n\t\t},\n\n\t\t// NodeListToJSON\n\t\t// Given a list of elements extrapolate their values and return as a json object\n\t\tnodeListToJSON: function(nodelist) {\n\n\t\t\tvar json = {};\n\n\t\t\t// Create a data string\n\t\t\tfor (var i = 0; i < nodelist.length; i++) {\n\n\t\t\t\tvar input = nodelist[i];\n\n\t\t\t\t// If the name of the input is empty or diabled, dont add it.\n\t\t\t\tif (input.disabled || !input.name) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Is this a file, does the browser not support 'files' and 'FormData'?\n\t\t\t\tif (input.type === 'file') {\n\t\t\t\t\tjson[input.name] = input;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjson[input.name] = input.value || input.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn json;\n\t\t}\n\t});\n\n\t// Replace it\n\thello.api = function() {\n\n\t\t// Get arguments\n\t\tvar p = utils.args({path: 's!', method: 's', data:'o', timeout: 'i', callback: 'f'}, arguments);\n\n\t\t// Change for into a data object\n\t\tif (p.data) {\n\t\t\tutils.dataToJSON(p);\n\t\t}\n\n\t\treturn api.call(this, p);\n\t};\n\n})(hello);\n","(function(hello) {\n\n\thello.init({\n\n\t\tfacebook: {\n\n\t\t\tname: 'Facebook',\n\n\t\t\t// SEE https://developers.facebook.com/docs/facebook-login/manually-build-a-login-flow/v2.1\n\t\t\toauth: {\n\t\t\t\tversion: 2,\n\t\t\t\tauth: 'https://www.facebook.com/dialog/oauth/',\n\t\t\t\tgrant: 'https://graph.facebook.com/oauth/access_token'\n\t\t\t},\n\n\t\t\t// Authorization scopes\n\t\t\tscope: {\n\t\t\t\tbasic: 'public_profile',\n\t\t\t\temail: 'email',\n\t\t\t\tbirthday: 'user_birthday',\n\t\t\t\tevents: 'user_events',\n\t\t\t\tphotos: 'user_photos,user_videos',\n\t\t\t\tvideos: 'user_photos,user_videos',\n\t\t\t\tfriends: 'user_friends',\n\t\t\t\tfiles: 'user_photos,user_videos',\n\t\t\t\tpublish_files: 'user_photos,user_videos,publish_actions',\n\t\t\t\tpublish: 'publish_actions',\n\n\t\t\t\t// Deprecated in v2.0\n\t\t\t\t// Create_event\t: 'create_event',\n\n\t\t\t\toffline_access: 'offline_access'\n\t\t\t},\n\n\t\t\t// Refresh the access_token\n\t\t\trefresh: true,\n\n\t\t\tlogin: function(p) {\n\t\t\t\t// Support Facebook's unique auth_type parameter\n\t\t\t\tif (p.options.auth_type) {\n\t\t\t\t\tp.qs.auth_type = p.options.auth_type;\n\t\t\t\t}\n\n\t\t\t\t// The facebook login window is a different size.\n\t\t\t\tp.options.window_width = 580;\n\t\t\t\tp.options.window_height = 400;\n\t\t\t},\n\n\t\t\tlogout: function(callback) {\n\t\t\t\t// Assign callback to a global handler\n\t\t\t\tvar callbackID = hello.utils.globalEvent(callback);\n\t\t\t\tvar redirect = encodeURIComponent(hello.settings.redirect_uri + '?' + hello.utils.param({callback:callbackID, result: JSON.stringify({force:true}), state: '{}'}));\n\t\t\t\tvar token = (hello.utils.store('facebook') || {}).access_token;\n\t\t\t\thello.utils.iframe('https://www.facebook.com/logout.php?next=' + redirect + '&access_token=' + token);\n\n\t\t\t\t// Possible responses:\n\t\t\t\t// String URL\t- hello.logout should handle the logout\n\t\t\t\t// Undefined\t- this function will handle the callback\n\t\t\t\t// True - throw a success, this callback isn't handling the callback\n\t\t\t\t// False - throw a error\n\t\t\t\tif (!token) {\n\t\t\t\t\t// If there isn't a token, the above wont return a response, so lets trigger a response\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// API Base URL\n\t\t\tbase: 'https://graph.facebook.com/',\n\n\t\t\t// Map GET requests\n\t\t\tget: {\n\t\t\t\tme: 'me',\n\t\t\t\t'me/friends': 'me/friends',\n\t\t\t\t'me/following': 'me/friends',\n\t\t\t\t'me/followers': 'me/friends',\n\t\t\t\t'me/share': 'me/feed',\n\t\t\t\t'me/like': 'me/likes',\n\t\t\t\t'me/files': 'me/albums',\n\t\t\t\t'me/albums': 'me/albums',\n\t\t\t\t'me/album': '@{id}/photos',\n\t\t\t\t'me/photos': 'me/photos',\n\t\t\t\t'me/photo': '@{id}',\n\t\t\t\t'friend/albums': '@{id}/albums',\n\t\t\t\t'friend/photos': '@{id}/photos'\n\n\t\t\t\t// Pagination\n\t\t\t\t// Https://developers.facebook.com/docs/reference/api/pagination/\n\t\t\t},\n\n\t\t\t// Map POST requests\n\t\t\tpost: {\n\t\t\t\t'me/share': 'me/feed',\n\t\t\t\t'me/photo': '@{id}'\n\n\t\t\t\t// Https://developers.facebook.com/docs/graph-api/reference/v2.2/object/likes/\n\t\t\t},\n\n\t\t\twrap: {\n\t\t\t\tme: formatUser,\n\t\t\t\t'me/friends': formatFriends,\n\t\t\t\t'me/following': formatFriends,\n\t\t\t\t'me/followers': formatFriends,\n\t\t\t\t'me/albums': format,\n\t\t\t\t'me/files': format,\n\t\t\t\t'default': format\n\t\t\t},\n\n\t\t\t// Special requirements for handling XHR\n\t\t\txhr: function(p, qs) {\n\t\t\t\tif (p.method === 'get' || p.method === 'post') {\n\t\t\t\t\tqs.suppress_response_codes = true;\n\t\t\t\t}\n\n\t\t\t\t// Is this a post with a data-uri?\n\t\t\t\tif (p.method === 'post' && p.data && typeof (p.data.file) === 'string') {\n\t\t\t\t\t// Convert the Data-URI to a Blob\n\t\t\t\t\tp.data.file = hello.utils.toBlob(p.data.file);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t// Special requirements for handling JSONP fallback\n\t\t\tjsonp: function(p, qs) {\n\t\t\t\tvar m = p.method;\n\t\t\t\tif (m !== 'get' && !hello.utils.hasBinary(p.data)) {\n\t\t\t\t\tp.data.method = m;\n\t\t\t\t\tp.method = 'get';\n\t\t\t\t}\n\t\t\t\telse if (p.method === 'delete') {\n\t\t\t\t\tqs.method = 'delete';\n\t\t\t\t\tp.method = 'post';\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Special requirements for iframe form hack\n\t\t\tform: function(p) {\n\t\t\t\treturn {\n\t\t\t\t\t// Fire the callback onload\n\t\t\t\t\tcallbackonload: true\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n\n\tvar base = 'https://graph.facebook.com/';\n\n\tfunction formatUser(o) {\n\t\tif (o.id) {\n\t\t\to.thumbnail = o.picture = 'https://graph.facebook.com/' + o.id + '/picture';\n\t\t}\n\n\t\treturn o;\n\t}\n\n\tfunction formatFriends(o) {\n\t\tif ('data' in o) {\n\t\t\to.data.forEach(formatUser);\n\t\t}\n\n\t\treturn o;\n\t}\n\n\tfunction format(o, headers, req) {\n\t\tif (typeof o === 'boolean') {\n\t\t\to = {success: o};\n\t\t}\n\n\t\tif (o && 'data' in o) {\n\t\t\tvar token = req.query.access_token;\n\t\t\to.data.forEach(function(d) {\n\t\t\t\tif (d.picture) {\n\t\t\t\t\td.thumbnail = d.picture;\n\t\t\t\t}\n\n\t\t\t\tif (d.cover_photo) {\n\t\t\t\t\td.thumbnail = base + d.cover_photo + '/picture?access_token=' + token;\n\t\t\t\t}\n\n\t\t\t\tif (d.type === 'album') {\n\t\t\t\t\td.files = d.photos = base + d.id + '/photos';\n\t\t\t\t}\n\n\t\t\t\tif (d.can_upload) {\n\t\t\t\t\td.upload_location = base + d.id + '/photos';\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn o;\n\t}\n\n})(hello);\n","(function(hello) {\n\n\thello.init({\n\n\t\tgithub: {\n\n\t\t\tname: 'GitHub',\n\n\t\t\toauth: {\n\t\t\t\tversion: 2,\n\t\t\t\tauth: 'https://github.com/login/oauth/authorize',\n\t\t\t\tgrant: 'https://github.com/login/oauth/access_token',\n\t\t\t\tresponse_type: 'code'\n\t\t\t},\n\n\t\t\tscope: {\n\t\t\t\tbasic: '',\n\t\t\t\temail: 'user:email'\n\t\t\t},\n\n\t\t\tbase: 'https://api.github.com/',\n\n\t\t\tget: {\n\t\t\t\tme: 'user',\n\t\t\t\t'me/friends': 'user/following?per_page=@{limit|100}',\n\t\t\t\t'me/following': 'user/following?per_page=@{limit|100}',\n\t\t\t\t'me/followers': 'user/followers?per_page=@{limit|100}',\n\t\t\t\t'me/like': 'user/starred?per_page=@{limit|100}'\n\t\t\t},\n\n\t\t\twrap: {\n\t\t\t\tme: function(o, headers) {\n\n\t\t\t\t\tformatError(o, headers);\n\t\t\t\t\tformatUser(o);\n\n\t\t\t\t\treturn o;\n\t\t\t\t},\n\n\t\t\t\t'default': function(o, headers, req) {\n\n\t\t\t\t\tformatError(o, headers);\n\n\t\t\t\t\tif (Array.isArray(o)) {\n\t\t\t\t\t\to = {data:o};\n\t\t\t\t\t}\n\n\t\t\t\t\tif (o.data) {\n\t\t\t\t\t\tpaging(o, headers, req);\n\t\t\t\t\t\to.data.forEach(formatUser);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn o;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\txhr: function(p) {\n\n\t\t\t\tif (p.method !== 'get' && p.data) {\n\n\t\t\t\t\t// Serialize payload as JSON\n\t\t\t\t\tp.headers = p.headers || {};\n\t\t\t\t\tp.headers['Content-Type'] = 'application/json';\n\t\t\t\t\tif (typeof (p.data) === 'object') {\n\t\t\t\t\t\tp.data = JSON.stringify(p.data);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\n\tfunction formatError(o, headers) {\n\t\tvar code = headers ? headers.statusCode : (o && 'meta' in o && 'status' in o.meta && o.meta.status);\n\t\tif ((code === 401 || code === 403)) {\n\t\t\to.error = {\n\t\t\t\tcode: 'access_denied',\n\t\t\t\tmessage: o.message || (o.data ? o.data.message : 'Could not get response')\n\t\t\t};\n\t\t\tdelete o.message;\n\t\t}\n\t}\n\n\tfunction formatUser(o) {\n\t\tif (o.id) {\n\t\t\to.thumbnail = o.picture = o.avatar_url;\n\t\t\to.name = o.login;\n\t\t}\n\t}\n\n\tfunction paging(res, headers, req) {\n\t\tif (res.data && res.data.length && headers && headers.Link) {\n\t\t\tvar next = headers.Link.match(/<(.*?)>;\\s*rel=\\\"next\\\"/);\n\t\t\tif (next) {\n\t\t\t\tres.paging = {\n\t\t\t\t\tnext: next[1]\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n})(hello);\n","(function(hello) {\n\n\t// URLs\n\tvar contactsUrl = 'https://www.google.com/m8/feeds/contacts/default/full?v=3.0&alt=json&max-results=@{limit|1000}&start-index=@{start|1}';\n\n\thello.init({\n\n\t\tgoogle: {\n\n\t\t\tname: 'Google Plus',\n\n\t\t\t// REF: http://code.google.com/apis/accounts/docs/OAuth2UserAgent.html\n\t\t\toauth: {\n\t\t\t\tversion: 2,\n\t\t\t\tauth: 'https://accounts.google.com/o/oauth2/auth',\n\t\t\t\tgrant: 'https://accounts.google.com/o/oauth2/token'\n\t\t\t},\n\n\t\t\t// Authorization scopes\n\t\t\tscope: {\n\t\t\t\tbasic: 'https://www.googleapis.com/auth/plus.me profile',\n\t\t\t\temail: 'email',\n\t\t\t\tbirthday: '',\n\t\t\t\tevents: '',\n\t\t\t\tphotos: 'https://picasaweb.google.com/data/',\n\t\t\t\tvideos: 'http://gdata.youtube.com',\n\t\t\t\tfriends: 'https://www.google.com/m8/feeds, https://www.googleapis.com/auth/plus.login',\n\t\t\t\tfiles: 'https://www.googleapis.com/auth/drive.readonly',\n\t\t\t\tpublish: '',\n\t\t\t\tpublish_files: 'https://www.googleapis.com/auth/drive',\n\t\t\t\tcreate_event: '',\n\t\t\t\toffline_access: ''\n\t\t\t},\n\n\t\t\tscope_delim: ' ',\n\n\t\t\t// Login\n\t\t\tlogin: function(p) {\n\t\t\t\tif (p.qs.display === 'none') {\n\t\t\t\t\t// Google doesn't like display=none\n\t\t\t\t\tp.qs.display = '';\n\t\t\t\t}\n\n\t\t\t\tif (p.qs.response_type === 'code') {\n\n\t\t\t\t\t// Lets set this to an offline access to return a refresh_token\n\t\t\t\t\tp.qs.access_type = 'offline';\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// API base URI\n\t\t\tbase: 'https://www.googleapis.com/',\n\n\t\t\t// Map GET requests\n\t\t\tget: {\n\t\t\t\tme: 'plus/v1/people/me',\n\n\t\t\t\t// Deprecated Sept 1, 2014\n\t\t\t\t//'me': 'oauth2/v1/userinfo?alt=json',\n\n\t\t\t\t// See: https://developers.google.com/+/api/latest/people/list\n\t\t\t\t'me/friends': 'plus/v1/people/me/people/visible?maxResults=@{limit|100}',\n\t\t\t\t'me/following': contactsUrl,\n\t\t\t\t'me/followers': contactsUrl,\n\t\t\t\t'me/contacts': contactsUrl,\n\t\t\t\t'me/share': 'plus/v1/people/me/activities/public?maxResults=@{limit|100}',\n\t\t\t\t'me/feed': 'plus/v1/people/me/activities/public?maxResults=@{limit|100}',\n\t\t\t\t'me/albums': 'https://picasaweb.google.com/data/feed/api/user/default?alt=json&max-results=@{limit|100}&start-index=@{start|1}',\n\t\t\t\t'me/album': function(p, callback) {\n\t\t\t\t\tvar key = p.query.id;\n\t\t\t\t\tdelete p.query.id;\n\t\t\t\t\tcallback(key.replace('/entry/', '/feed/'));\n\t\t\t\t},\n\n\t\t\t\t'me/photos': 'https://picasaweb.google.com/data/feed/api/user/default?alt=json&kind=photo&max-results=@{limit|100}&start-index=@{start|1}',\n\n\t\t\t\t// See: https://developers.google.com/drive/v2/reference/files/list\n\t\t\t\t'me/files': 'drive/v2/files?q=%22@{parent|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}',\n\n\t\t\t\t// See: https://developers.google.com/drive/v2/reference/files/list\n\t\t\t\t'me/folders': 'drive/v2/files?q=%22@{id|root}%22+in+parents+and+mimeType+=+%22application/vnd.google-apps.folder%22+and+trashed=false&maxResults=@{limit|100}',\n\n\t\t\t\t// See: https://developers.google.com/drive/v2/reference/files/list\n\t\t\t\t'me/folder': 'drive/v2/files?q=%22@{id|root}%22+in+parents+and+trashed=false&maxResults=@{limit|100}'\n\t\t\t},\n\n\t\t\t// Map POST requests\n\t\t\tpost: {\n\n\t\t\t\t// Google Drive\n\t\t\t\t'me/files': uploadDrive,\n\t\t\t\t'me/folders': function(p, callback) {\n\t\t\t\t\tp.data = {\n\t\t\t\t\t\ttitle: p.data.name,\n\t\t\t\t\t\tparents: [{id: p.data.parent || 'root'}],\n\t\t\t\t\t\tmimeType: 'application/vnd.google-apps.folder'\n\t\t\t\t\t};\n\t\t\t\t\tcallback('drive/v2/files');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// Map PUT requests\n\t\t\tput: {\n\t\t\t\t'me/files': uploadDrive\n\t\t\t},\n\n\t\t\t// Map DELETE requests\n\t\t\tdel: {\n\t\t\t\t'me/files': 'drive/v2/files/@{id}',\n\t\t\t\t'me/folder': 'drive/v2/files/@{id}'\n\t\t\t},\n\n\t\t\twrap: {\n\t\t\t\tme: function(o) {\n\t\t\t\t\tif (o.id) {\n\t\t\t\t\t\to.last_name = o.family_name || (o.name ? o.name.familyName : null);\n\t\t\t\t\t\to.first_name = o.given_name || (o.name ? o.name.givenName : null);\n\n\t\t\t\t\t\tif (o.emails && o.emails.length) {\n\t\t\t\t\t\t\to.email = o.emails[0].value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tformatPerson(o);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn o;\n\t\t\t\t},\n\n\t\t\t\t'me/friends': function(o) {\n\t\t\t\t\tif (o.items) {\n\t\t\t\t\t\tpaging(o);\n\t\t\t\t\t\to.data = o.items;\n\t\t\t\t\t\to.data.forEach(formatPerson);\n\t\t\t\t\t\tdelete o.items;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn o;\n\t\t\t\t},\n\n\t\t\t\t'me/contacts': formatFriends,\n\t\t\t\t'me/followers': formatFriends,\n\t\t\t\t'me/following': formatFriends,\n\t\t\t\t'me/share': formatFeed,\n\t\t\t\t'me/feed': formatFeed,\n\t\t\t\t'me/albums': gEntry,\n\t\t\t\t'me/photos': gEntry,\n\t\t\t\t'default': gEntry\n\t\t\t},\n\n\t\t\txhr: function(p) {\n\n\t\t\t\tif (p.method === 'post' || p.method === 'put') {\n\t\t\t\t\ttoJSON(p);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t// Don't even try submitting via form.\n\t\t\t// This means no POST operations in <=IE9\n\t\t\tform: false\n\t\t}\n\t});\n\n\tfunction toInt(s) {\n\t\treturn parseInt(s, 10);\n\t}\n\n\tfunction formatFeed(o) {\n\t\tpaging(o);\n\t\to.data = o.items;\n\t\tdelete o.items;\n\t\treturn o;\n\t}\n\n\t// Format: ensure each record contains a name, id etc.\n\tfunction formatItem(o) {\n\t\tif (o.error) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!o.name) {\n\t\t\to.name = o.title || o.message;\n\t\t}\n\n\t\tif (!o.picture) {\n\t\t\to.picture = o.thumbnailLink;\n\t\t}\n\n\t\tif (!o.thumbnail) {\n\t\t\to.thumbnail = o.thumbnailLink;\n\t\t}\n\n\t\tif (o.mimeType === 'application/vnd.google-apps.folder') {\n\t\t\to.type = 'folder';\n\t\t\to.files = 'https://www.googleapis.com/drive/v2/files?q=%22' + o.id + '%22+in+parents';\n\t\t}\n\n\t\treturn o;\n\t}\n\n\tfunction formatImage(item) {\n\t\treturn {\n\t\t\tsource: item.url,\n\t\t\twidth: item.width,\n\t\t\theight: item.height\n\t\t};\n\t}\n\n\t// Google has a horrible JSON API\n\tfunction gEntry(o) {\n\t\tpaging(o);\n\n\t\tif ('feed' in o && 'entry' in o.feed) {\n\t\t\to.data = o.feed.entry.map(formatEntry);\n\t\t\tdelete o.feed;\n\t\t}\n\n\t\t// Old style, Picasa, etc...\n\t\telse if ('entry' in o) {\n\t\t\treturn formatEntry(o.entry);\n\t\t}\n\n\t\t// New Style, Google Drive & Plus\n\t\telse if ('items' in o) {\n\t\t\to.data = o.items.map(formatItem);\n\t\t\tdelete o.items;\n\t\t}\n\t\telse {\n\t\t\tformatItem(o);\n\t\t}\n\n\t\treturn o;\n\t}\n\n\tfunction formatPerson(o) {\n\t\to.name = o.displayName || o.name;\n\t\to.picture = o.picture || (o.image ? o.image.url : null);\n\t\to.thumbnail = o.picture;\n\t}\n\n\tfunction formatFriends(o, headers, req) {\n\t\tpaging(o);\n\t\tvar r = [];\n\t\tif ('feed' in o && 'entry' in o.feed) {\n\t\t\tvar token = req.query.access_token;\n\t\t\tfor (var i = 0; i < o.feed.entry.length; i++) {\n\t\t\t\tvar a = o.feed.entry[i];\n\n\t\t\t\ta.id\t= a.id.$t;\n\t\t\t\ta.name\t= a.title.$t;\n\t\t\t\tdelete a.title;\n\t\t\t\tif (a.gd$email) {\n\t\t\t\t\ta.email\t= (a.gd$email && a.gd$email.length > 0) ? a.gd$email[0].address : null;\n\t\t\t\t\ta.emails = a.gd$email;\n\t\t\t\t\tdelete a.gd$email;\n\t\t\t\t}\n\n\t\t\t\tif (a.updated) {\n\t\t\t\t\ta.updated = a.updated.$t;\n\t\t\t\t}\n\n\t\t\t\tif (a.link) {\n\t\t\t\t\tvar pic = (a.link.length > 0) ? a.link[0].href + '?access_token=' + token : null;\n\t\t\t\t\tif (pic) {\n\t\t\t\t\t\ta.picture = pic;\n\t\t\t\t\t\ta.thumbnail = pic;\n\t\t\t\t\t}\n\n\t\t\t\t\tdelete a.link;\n\t\t\t\t}\n\n\t\t\t\tif (a.category) {\n\t\t\t\t\tdelete a.category;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\to.data = o.feed.entry;\n\t\t\tdelete o.feed;\n\t\t}\n\n\t\treturn o;\n\t}\n\n\tfunction formatEntry(a) {\n\n\t\tvar group = a.media$group;\n\t\tvar media = group.media$content.length ? group.media$content[0] : {};\n\t\tvar i = 0;\n\t\tvar _a;\n\t\tvar p = {\n\t\t\tid: a.id.$t,\n\t\t\tname: a.title.$t,\n\t\t\tdescription: a.summary.$t,\n\t\t\tupdated_time: a.updated.$t,\n\t\t\tcreated_time: a.published.$t,\n\t\t\tpicture: media ? media.url : null,\n\t\t\timages: [],\n\t\t\tthumbnail: media ? media.url : null,\n\t\t\twidth: media.width,\n\t\t\theight: media.height\n\t\t};\n\n\t\t// Get feed/children\n\t\tif ('link' in a) {\n\t\t\tfor (i = 0; i < a.link.length; i++) {\n\t\t\t\tvar d = a.link[i];\n\t\t\t\tif (d.rel.match(/\\#feed$/)) {\n\t\t\t\t\tp.upload_location = p.files = p.photos = d.href;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Get images of different scales\n\t\tif ('category' in a && a.category.length) {\n\t\t\t_a = a.category;\n\t\t\tfor (i = 0; i < _a.length; i++) {\n\t\t\t\tif (_a[i].scheme && _a[i].scheme.match(/\\#kind$/)) {\n\t\t\t\t\tp.type = _a[i].term.replace(/^.*?\\#/, '');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Get images of different scales\n\t\tif ('media$thumbnail' in group && group.media$thumbnail.length) {\n\t\t\t_a = group.media$thumbnail;\n\t\t\tp.thumbnail = _a[0].url;\n\t\t\tp.images = _a.map(formatImage);\n\t\t}\n\n\t\t_a = group.media$content;\n\n\t\tif (_a && _a.length) {\n\t\t\tp.images.push(formatImage(_a[0]));\n\t\t}\n\n\t\treturn p;\n\t}\n\n\tfunction paging(res) {\n\n\t\t// Contacts V2\n\t\tif ('feed' in res && res.feed.openSearch$itemsPerPage) {\n\t\t\tvar limit = toInt(res.feed.openSearch$itemsPerPage.$t);\n\t\t\tvar start = toInt(res.feed.openSearch$startIndex.$t);\n\t\t\tvar total = toInt(res.feed.openSearch$totalResults.$t);\n\n\t\t\tif ((start + limit) < total) {\n\t\t\t\tres.paging = {\n\t\t\t\t\tnext: '?start=' + (start + limit)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\telse if ('nextPageToken' in res) {\n\t\t\tres.paging = {\n\t\t\t\tnext: '?pageToken=' + res.nextPageToken\n\t\t\t};\n\t\t}\n\t}\n\n\t// Construct a multipart message\n\tfunction Multipart() {\n\n\t\t// Internal body\n\t\tvar body = [];\n\t\tvar boundary = (Math.random() * 1e10).toString(32);\n\t\tvar counter = 0;\n\t\tvar lineBreak = '\\r\\n';\n\t\tvar delim = lineBreak + '--' + boundary;\n\t\tvar ready = function() {};\n\n\t\tvar dataUri = /^data\\:([^;,]+(\\;charset=[^;,]+)?)(\\;base64)?,/i;\n\n\t\t// Add file\n\t\tfunction addFile(item) {\n\t\t\tvar fr = new FileReader();\n\t\t\tfr.onload = function(e) {\n\t\t\t\taddContent(btoa(e.target.result), item.type + lineBreak + 'Content-Transfer-Encoding: base64');\n\t\t\t};\n\n\t\t\tfr.readAsBinaryString(item);\n\t\t}\n\n\t\t// Add content\n\t\tfunction addContent(content, type) {\n\t\t\tbody.push(lineBreak + 'Content-Type: ' + type + lineBreak + lineBreak + content);\n\t\t\tcounter--;\n\t\t\tready();\n\t\t}\n\n\t\t// Add new things to the object\n\t\tthis.append = function(content, type) {\n\n\t\t\t// Does the content have an array\n\t\t\tif (typeof (content) === 'string' || !('length' in Object(content))) {\n\t\t\t\t// Converti to multiples\n\t\t\t\tcontent = [content];\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < content.length; i++) {\n\n\t\t\t\tcounter++;\n\n\t\t\t\tvar item = content[i];\n\n\t\t\t\t// Is this a file?\n\t\t\t\t// Files can be either Blobs or File types\n\t\t\t\tif (\n\t\t\t\t\t(typeof (File) !== 'undefined' && item instanceof File) ||\n\t\t\t\t\t(typeof (Blob) !== 'undefined' && item instanceof Blob)\n\t\t\t\t) {\n\t\t\t\t\t// Read the file in\n\t\t\t\t\taddFile(item);\n\t\t\t\t}\n\n\t\t\t\t// Data-URI?\n\t\t\t\t// Data:[<mime type>][;charset=<charset>][;base64],<encoded data>\n\t\t\t\t// /^data\\:([^;,]+(\\;charset=[^;,]+)?)(\\;base64)?,/i\n\t\t\t\telse if (typeof (item) === 'string' && item.match(dataUri)) {\n\t\t\t\t\tvar m = item.match(dataUri);\n\t\t\t\t\taddContent(item.replace(dataUri, ''), m[1] + lineBreak + 'Content-Transfer-Encoding: base64');\n\t\t\t\t}\n\n\t\t\t\t// Regular string\n\t\t\t\telse {\n\t\t\t\t\taddContent(item, type);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.onready = function(fn) {\n\t\t\tready = function() {\n\t\t\t\tif (counter === 0) {\n\t\t\t\t\t// Trigger ready\n\t\t\t\t\tbody.unshift('');\n\t\t\t\t\tbody.push('--');\n\t\t\t\t\tfn(body.join(delim), boundary);\n\t\t\t\t\tbody = [];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tready();\n\t\t};\n\t}\n\n\t// Upload to Drive\n\t// If this is PUT then only augment the file uploaded\n\t// PUT https://developers.google.com/drive/v2/reference/files/update\n\t// POST https://developers.google.com/drive/manage-uploads\n\tfunction uploadDrive(p, callback) {\n\n\t\tvar data = {};\n\n\t\t// Test for DOM element\n\t\tif (p.data &&\n\t\t\t(typeof (HTMLInputElement) !== 'undefined' && p.data instanceof HTMLInputElement)\n\t\t) {\n\t\t\tp.data = {file: p.data};\n\t\t}\n\n\t\tif (!p.data.name && Object(Object(p.data.file).files).length && p.method === 'post') {\n\t\t\tp.data.name = p.data.file.files[0].name;\n\t\t}\n\n\t\tif (p.method === 'post') {\n\t\t\tp.data = {\n\t\t\t\ttitle: p.data.name,\n\t\t\t\tparents: [{id: p.data.parent || 'root'}],\n\t\t\t\tfile: p.data.file\n\t\t\t};\n\t\t}\n\t\telse {\n\n\t\t\t// Make a reference\n\t\t\tdata = p.data;\n\t\t\tp.data = {};\n\n\t\t\t// Add the parts to change as required\n\t\t\tif (data.parent) {\n\t\t\t\tp.data.parents = [{id: p.data.parent || 'root'}];\n\t\t\t}\n\n\t\t\tif (data.file) {\n\t\t\t\tp.data.file = data.file;\n\t\t\t}\n\n\t\t\tif (data.name) {\n\t\t\t\tp.data.title = data.name;\n\t\t\t}\n\t\t}\n\n\t\t// Extract the file, if it exists from the data object\n\t\t// If the File is an INPUT element lets just concern ourselves with the NodeList\n\t\tvar file;\n\t\tif ('file' in p.data) {\n\t\t\tfile = p.data.file;\n\t\t\tdelete p.data.file;\n\n\t\t\tif (typeof (file) === 'object' && 'files' in file) {\n\t\t\t\t// Assign the NodeList\n\t\t\t\tfile = file.files;\n\t\t\t}\n\n\t\t\tif (!file || !file.length) {\n\t\t\t\tcallback({\n\t\t\t\t\terror: {\n\t\t\t\t\t\tcode: 'request_invalid',\n\t\t\t\t\t\tmessage: 'There were no files attached with this request to upload'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Set type p.data.mimeType = Object(file[0]).type || 'application/octet-stream';\n\n\t\t// Construct a multipart message\n\t\tvar parts = new Multipart();\n\t\tparts.append(JSON.stringify(p.data), 'application/json');\n\n\t\t// Read the file into a  base64 string... yep a hassle, i know\n\t\t// FormData doesn't let us assign our own Multipart headers and HTTP Content-Type\n\t\t// Alas GoogleApi need these in a particular format\n\t\tif (file) {\n\t\t\tparts.append(file);\n\t\t}\n\n\t\tparts.onready(function(body, boundary) {\n\n\t\t\tp.headers['content-type'] = 'multipart/related; boundary=\"' + boundary + '\"';\n\t\t\tp.data = body;\n\n\t\t\tcallback('upload/drive/v2/files' + (data.id ? '/' + data.id : '') + '?uploadType=multipart');\n\t\t});\n\n\t}\n\n\tfunction toJSON(p) {\n\t\tif (typeof (p.data) === 'object') {\n\t\t\t// Convert the POST into a javascript object\n\t\t\ttry {\n\t\t\t\tp.data = JSON.stringify(p.data);\n\t\t\t\tp.headers['content-type'] = 'application/json';\n\t\t\t}\n\t\t\tcatch (e) {}\n\t\t}\n\t}\n\n})(hello);\n","// Register as anonymous AMD module\nif (typeof define === 'function' && define.amd) {\n\tdefine(function() {\n\t\treturn hello;\n\t});\n}\n"],"sourceRoot":"/source/"}